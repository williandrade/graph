!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Viva=t()}}(function(){return function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){var r=t("ngraph.random"),o={lazyExtend:function(){return t("ngraph.merge").apply(this,arguments)},randomIterator:function(){return r.randomIterator.apply(r,arguments)},random:function(){return r.random.apply(r,arguments)},events:t("ngraph.events")};o.Graph={version:t("./version.js"),graph:t("ngraph.graph"),serializer:function(){return{loadFromJSON:t("ngraph.fromjson"),storeToJSON:t("ngraph.tojson")}},centrality:t("./Algorithms/centrality.js"),operations:t("./Algorithms/operations.js"),geom:function(){return{intersect:t("gintersect"),intersectRect:t("./Utils/intersectRect.js")}},webgl:t("./WebGL/webgl.js"),webglInputEvents:t("./WebGL/webglInputEvents.js"),generator:function(){return t("ngraph.generators")},Input:{domInputManager:t("./Input/domInputManager.js"),webglInputManager:t("./Input/webglInputManager.js")},Utils:{dragndrop:t("./Input/dragndrop.js"),Bezier:t("./Utils/bezier.js"),utils:t("./Utils/utils.js"),PolyBezier:t("./Utils/poly-bezier.js"),findElementPosition:t("./Utils/findElementPosition.js"),timer:t("./Utils/timer.js"),getDimension:t("./Utils/getDimensions.js"),events:t("./Utils/backwardCompatibleEvents.js")},Layout:{forceDirected:t("ngraph.forcelayout"),constant:t("./Layout/constant.js")},View:{Texture:t("./WebGL/texture.js"),webglAtlas:t("./WebGL/webglAtlas.js"),webglImageNodeProgram:t("./WebGL/webglImageNodeProgram.js"),webglLinkProgram:t("./WebGL/webglLinkProgram.js"),webglNodeProgram:t("./WebGL/webglNodeProgram.js"),webglLine:t("./WebGL/webglLine.js"),webglSquare:t("./WebGL/webglSquare.js"),webglImage:t("./WebGL/webglImage.js"),webglGraphics:t("./View/webglGraphics.js"),_webglUtil:{parseColor:t("./WebGL/parseColor.js")},svgGraphics:t("./View/svgGraphics.js"),renderer:t("./View/renderer.js"),cssGraphics:function(){throw new Error("cssGraphics is deprecated. Please use older version of vivagraph (< 0.7) if you need it")},svgNodeFactory:function(){throw new Error("svgNodeFactory is deprecated. Please use older version of vivagraph (< 0.7) if you need it")},community:function(){throw new Error("community is deprecated. Please use vivagraph < 0.7 if you need it, or `https://github.com/anvaka/ngraph.slpa` module")}},Rect:t("./Utils/rect.js"),svg:t("simplesvg"),BrowserInfo:t("./Utils/browserInfo.js")},e.exports=o},{"./Algorithms/centrality.js":32,"./Algorithms/operations.js":33,"./Input/domInputManager.js":34,"./Input/dragndrop.js":35,"./Input/webglInputManager.js":36,"./Layout/constant.js":37,"./Utils/backwardCompatibleEvents.js":38,"./Utils/bezier.js":39,"./Utils/browserInfo.js":40,"./Utils/findElementPosition.js":42,"./Utils/getDimensions.js":43,"./Utils/intersectRect.js":44,"./Utils/poly-bezier.js":46,"./Utils/rect.js":47,"./Utils/timer.js":48,"./Utils/utils.js":49,"./View/renderer.js":51,"./View/svgGraphics.js":52,"./View/webglGraphics.js":53,"./WebGL/parseColor.js":54,"./WebGL/texture.js":55,"./WebGL/webgl.js":56,"./WebGL/webglAtlas.js":57,"./WebGL/webglImage.js":58,"./WebGL/webglImageNodeProgram.js":59,"./WebGL/webglInputEvents.js":60,"./WebGL/webglLine.js":61,"./WebGL/webglLinkProgram.js":62,"./WebGL/webglNodeProgram.js":63,"./WebGL/webglSquare.js":64,"./version.js":65,gintersect:3,"ngraph.events":7,"ngraph.forcelayout":9,"ngraph.fromjson":10,"ngraph.generators":11,"ngraph.graph":12,"ngraph.merge":13,"ngraph.random":26,"ngraph.tojson":27,simplesvg:28}],2:[function(t,e,n){function r(t,e,n,r){return f=f||(document.addEventListener?{add:i,rm:a}:{add:s,rm:u}),f.add(t,e,n,r)}function o(t,e,n,r){return f=f||(document.addEventListener?{add:i,rm:a}:{add:s,rm:u}),f.rm(t,e,n,r)}function i(t,e,n,r){t.addEventListener(e,n,r)}function a(t,e,n,r){t.removeEventListener(e,n,r)}function s(t,e,n,r){if(r)throw new Error("cannot useCapture in oldIE");t.attachEvent("on"+e,n)}function u(t,e,n,r){t.detachEvent("on"+e,n)}r.removeEventListener=o,r.addEventListener=r,e.exports=r;var f=null},{}],3:[function(t,e,n){function r(t,e,n,r,o,i,a,s){var u,f,c,l,d,p,h,v,g,m,y,x,b,w={x:0,y:0};return u=r-e,c=t-n,d=n*e-t*r,g=u*o+c*i+d,m=u*a+c*s+d,0!==g&&0!==m&&g>=0==m>=4?null:(f=s-i,l=o-a,p=a*i-o*s,h=f*t+l*e+p,v=f*n+l*r+p,0!==h&&0!==v&&h>=0==v>=0?null:(y=u*l-f*c,0===y?null:(x=y<0?-y/2:y/2,x=0,b=c*p-l*d,w.x=(b<0?b-x:b+x)/y,b=f*d-u*p,w.y=(b<0?b-x:b+x)/y,w)))}e.exports=r},{}],4:[function(t,e,n){e.exports.degree=t("./src/degree.js"),e.exports.betweenness=t("./src/betweenness.js")},{"./src/betweenness.js":5,"./src/degree.js":6}],5:[function(t,e,n){function r(t,e){function n(t){v[t]/=2}function r(t){v[t.id]=0}function o(t){u=t.id,s(u),i()}function i(){for(t.forEachNode(a);c.length;){for(var e=c.pop(),n=(1+h[e])/p[e],r=l[e],o=0;o<r.length;++o){var i=r[o];h[i]+=p[i]*n}e!==u&&(v[e]+=h[e])}}function a(t){h[t.id]=0}function s(n){function r(t){i(t.id)}function o(t){var e=t.id;l[e]=[],d[e]=-1,p[e]=0}function i(t){d[t]===-1&&(d[t]=d[a]+1,f.push(t)),d[t]===d[a]+1&&(p[t]+=p[a],l[t].push(a))}for(t.forEachNode(o),d[n]=0,p[n]=1,f.push(n);f.length;){var a=f.shift();Object.create(null);c.push(a),t.forEachLinkedNode(a,r,e)}}var u,f=[],c=[],l=Object.create(null),d=Object.create(null),p=Object.create(null),h=Object.create(null),v=Object.create(null);return t.forEachNode(r),t.forEachNode(o),e||Object.keys(v).forEach(n),v}e.exports=r},{}],6:[function(t,e,n){function r(t,e){function n(e){var n=t.getLinks(e.id);s[e.id]=r(n,e.id)}var r,s=Object.create(null);if(e=(e||"both").toLowerCase(),"both"===e||"inout"===e)r=a;else if("in"===e)r=o;else{if("out"!==e)throw new Error("Expected centrality degree kind is: in, out or both");r=i}return t.forEachNode(n),s}function o(t,e){for(var n=0,r=0;r<t.length;r+=1)n+=t[r].toId===e?1:0;return n}function i(t,e){for(var n=0,r=0;r<t.length;r+=1)n+=t[r].fromId===e?1:0;return n}function a(t){return t.length}e.exports=r},{}],7:[function(t,e,n){function r(t){var e=Object.create(null);return{on:function(n,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=e[n];return i||(i=e[n]=[]),i.push({callback:r,ctx:o}),t},off:function(n,r){var o="undefined"==typeof n;if(o)return e=Object.create(null),t;if(e[n]){var i="function"!=typeof r;if(i)delete e[n];else for(var a=e[n],s=0;s<a.length;++s)a[s].callback===r&&a.splice(s,1)}return t},fire:function(n){var r=e[n];if(!r)return t;var o;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var a=r[i];a.callback.apply(a.ctx,o)}return t}}}function o(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],n=0;n<e.length;++n)if(t.hasOwnProperty(e[n]))throw new Error("Subject cannot be eventified, since it already has property '"+e[n]+"'")}e.exports=function(t){o(t);var e=r(t);return t.on=e.on,t.off=e.off,t.fire=e.fire,t}},{}],8:[function(t,e,n){function r(t,e,n){var r="[object Array]"===Object.prototype.toString.call(n);if(r)for(var i=0;i<n.length;++i)o(t,e,n[i]);else for(var a in t)o(t,e,a)}function o(t,e,n){if(t.hasOwnProperty(n)){if("function"==typeof e[n])return;e[n]=function(r){return void 0!==r?(t[n]=r,e):t[n]}}}e.exports=r},{}],9:[function(t,e,n){function r(e,n){function r(t,n){var r;if(void 0===n)r="string"==typeof t?t:t.id;else{var o=e.hasLink(t,n);if(!o)return;r=o.id}return w[r]}function i(t){return b[t]}function a(){e.on("changed",s)}function s(t){for(var e=0;e<t.length;++e){var n=t[e];"add"===n.changeType?(n.node&&f(n.node.id),n.link&&l(n.link)):"remove"===n.changeType&&(n.node&&c(n.node),n.link&&d(n.link))}}function u(){e.forEachNode(function(t){f(t.id)}),e.forEachLink(l)}function f(t){var n=b[t];if(!n){var r=e.getNode(t);if(!r)throw new Error("initBody() was called with unknown node id");var o=r.position;if(!o){var i=p(r);o=x.getBestNewBodyPosition(i)}n=x.addBodyAt(o),b[t]=n,h(t),v(r)&&(n.isPinned=!0)}}function c(t){var e=t.id,n=b[e];n&&(b[e]=null,delete b[e],x.removeBody(n))}function l(t){h(t.fromId),h(t.toId);var e=b[t.fromId],n=b[t.toId],r=x.addSpring(e,n,t.length);E(t,r),w[t.id]=r}function d(t){var n=w[t.id];if(n){var r=e.getNode(t.fromId),o=e.getNode(t.toId);r&&h(r.id),o&&h(o.id),delete w[t.id],x.removeSpring(n)}}function p(t){var e=[];if(!t.links)return e;for(var n=Math.min(t.links.length,2),r=0;r<n;++r){var o=t.links[r],i=o.fromId!==t.id?b[o.fromId]:b[o.toId];i&&i.pos&&e.push(i)}return e}function h(t){var e=b[t];e.mass=m(t)}function v(t){return t&&(t.isPinned||t.data&&t.data.isPinned)}function g(t){var e=b[t];return e||(f(t),e=b[t]),e}function m(t){return 1+e.getLinks(t).length/3}if(!e)throw new Error("Graph structure cannot be undefined");var y=t("ngraph.physics.simulator"),x=y(n),b="function"==typeof Object.create?Object.create(null):{},w={},E=x.settings.springTransform||o;u(),a();var _={step:function(){return x.step()},getNodePosition:function(t){return g(t).pos},setNodePosition:function(t){var e=g(t);e.setPosition.apply(e,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(t){var e=w[t];if(e)return{from:e.from.pos,to:e.to.pos}},getGraphRect:function(){return x.getBBox()},pinNode:function(t,e){var n=g(t.id);n.isPinned=!!e},isNodePinned:function(t){return g(t.id).isPinned},dispose:function(){e.off("changed",s)},getBody:i,getSpring:r,simulator:x};return _}function o(){}e.exports=r,e.exports.simulator=t("ngraph.physics.simulator")},{"ngraph.physics.simulator":15}],10:[function(t,e,n){function r(t,e,n){var r;e=e||o,n=n||o,r="string"==typeof t?JSON.parse(t):t;var a,s=i();if(void 0===r.links||void 0===r.nodes)throw new Error("Cannot load graph without links and nodes");for(a=0;a<r.nodes.length;++a){var u=e(r.nodes[a]);if(!u.hasOwnProperty("id"))throw new Error("Graph node format is invalid: Node id is missing");s.addNode(u.id,u.data)}for(a=0;a<r.links.length;++a){var f=n(r.links[a]);if(!f.hasOwnProperty("fromId")||!f.hasOwnProperty("toId"))throw new Error("Graph link format is invalid. Both fromId and toId are required");s.addLink(f.fromId,f.toId,f.data)}return s}function o(t){return t}e.exports=r;var i=t("ngraph.graph")},{"ngraph.graph":12}],11:[function(t,e,n){function r(t){if(!t||t<0)throw new Error("Invalid number of nodes");var e,n=p();for(e=0;e<t-1;++e)n.addLink(e,e+1),n.addLink(t+e,t+e+1),n.addLink(e,t+e);return n.addLink(t-1,2*t-1),n}function o(t){if(!t||t<0)throw new Error("Invalid number of nodes");var e=r(t);return e.addLink(0,t-1),e.addLink(t,2*t-1),e}function i(t){if(!t||t<1)throw new Error("At least two nodes are expected for complete graph");var e,n,r=p();for(e=0;e<t;++e)for(n=e+1;n<t;++n)e!==n&&r.addLink(e,n);return r}function a(t,e){if(!t||!e||t<0||e<0)throw new Error("Graph dimensions are invalid. Number of nodes in each partition should be greater than 0");var n,r,o=p();for(n=0;n<t;++n)for(r=t;r<t+e;++r)o.addLink(n,r);return o}function s(t){if(!t||t<0)throw new Error("Invalid number of nodes");var e,n=p();for(n.addNode(0),e=1;e<t;++e)n.addLink(e-1,e);return n}function u(t,e){if(t<1||e<1)throw new Error("Invalid number of nodes in grid graph");var n,r,o=p();if(1===t&&1===e)return o.addNode(0),o;for(n=0;n<t;++n)for(r=0;r<e;++r){var i=n+r*t;n>0&&o.addLink(i,n-1+r*t),r>0&&o.addLink(i,n+(r-1)*t)}return o}function f(t,e,n){if(t<1||e<1||n<1)throw new Error("Invalid number of nodes in grid3 graph");var r,o,i,a=p();if(1===t&&1===e&&1===n)return a.addNode(0),a;for(i=0;i<n;++i)for(r=0;r<t;++r)for(o=0;o<e;++o){var s=i*t*e,u=r+o*t+s;r>0&&a.addLink(u,r-1+o*t+s),o>0&&a.addLink(u,r+(o-1)*t+s),i>0&&a.addLink(u,r+o*t+(i-1)*t*e)}return a}function c(t){if(t<0)throw new Error("Invalid number of nodes in balanced tree");var e,n=p(),r=Math.pow(2,t);for(0===t&&n.addNode(1),e=1;e<r;++e){var o=e,i=2*o,a=2*o+1;n.addLink(o,i),n.addLink(o,a)}return n}function l(t){if(t<0)throw new Error("Number of nodes shoul be >= 0");var e,n=p();for(e=0;e<t;++e)n.addNode(e);return n}function d(e,n,r,o){if(n>=e)throw new Error("Choose smaller `k`. It cannot be larger than number of nodes `n`");var i,a,s=t("ngraph.random").random(o||42),u=p();for(i=0;i<e;++i)u.addNode(i);for(var f=Math.floor(n/2+1),c=1;c<f;++c)for(i=0;i<e;++i)a=(c+i)%e,u.addLink(i,a);for(c=1;c<f;++c)for(i=0;i<e;++i)if(s.nextDouble()<r){var l=i;a=(c+i)%e;var d=s.next(e),h=d===l||u.hasLink(l,d);if(h&&u.getLinks(l).length===e-1)continue;for(;h;)d=s.next(e),h=d===l||u.hasLink(l,d);var v=u.hasLink(l,a);u.removeLink(v),u.addLink(l,d)}return u}e.exports={ladder:r,complete:i,completeBipartite:a,balancedBinTree:c,path:s,circularLadder:o,grid:u,grid3:f,noLinks:l,wattsStrogatz:d};var p=t("ngraph.graph")},{"ngraph.graph":12,"ngraph.random":26}],12:[function(t,e,n){function r(t){function e(){function t(){return B.beginUpdate=O=_,B.endUpdate=R=L,U=n,D=r,B.on=e,e.apply(B,arguments)}var e=B.on;B.on=t}function n(t,e){M.push({link:t,changeType:e})}function r(t,e){M.push({node:t,changeType:e})}function u(t,e){if(void 0===t)throw new Error("Invalid node identifier");O();var n=f(t);return n?D(n,"update"):(n=new i(t),I++,D(n,"add")),n.data=e,k[t]=n,R(),n}function f(t){return k[t]}function c(t){var e=f(t);if(!e)return!1;for(O();e.links.length;){var n=e.links[0];v(n)}return delete k[t],I--,D(e,"remove"),R(),!0}function l(t,e,n){O();var r=f(t)||u(t),o=f(e)||u(e),i=C(t,e,n);return N.push(i),r.links.push(i),t!==e&&o.links.push(i),U(i,"add"),R(),i}function d(t,e,n){var r=t.toString()+e.toString();return new a(t,e,n,r)}function p(t,e,n){var r=t.toString()+"👉 "+e.toString(),o=A.hasOwnProperty(r);return(o||g(t,e))&&(o||(A[r]=0),r+="@"+ ++A[r]),new a(t,e,n,r)}function h(t){var e=f(t);return e?e.links:null}function v(t){if(!t)return!1;var e=o(t,N);if(e<0)return!1;O(),N.splice(e,1);var n=f(t.fromId),r=f(t.toId);return n&&(e=o(t,n.links),e>=0&&n.links.splice(e,1)),r&&(e=o(t,r.links),e>=0&&r.links.splice(e,1)),U(t,"remove"),R(),!0}function g(t,e){var n,r=f(t);if(!r)return null;for(n=0;n<r.links.length;++n){var o=r.links[n];if(o.fromId===t&&o.toId===e)return o}return null}function m(){O(),S(function(t){c(t.id)}),R()}function y(t){var e,n;if("function"==typeof t)for(e=0,n=N.length;e<n;++e)t(N[e])}function x(t,e,n){var r=f(t);if(r&&r.links&&"function"==typeof e)return n?w(r.links,t,e):b(r.links,t,e)}function b(t,e,n){for(var r,o=0;o<t.length;++o){var i=t[o],a=i.fromId===e?i.toId:i.fromId;if(r=n(k[a],i))return!0}}function w(t,e,n){for(var r,o=0;o<t.length;++o){var i=t[o];if(i.fromId===e&&(r=n(k[i.toId],i)))return!0}}function E(){}function _(){T+=1}function L(){T-=1,0===T&&M.length>0&&(B.fire("changed",M),M.length=0)}function j(){return Object.keys?P:z}function P(t){if("function"==typeof t)for(var e=Object.keys(k),n=0;n<e.length;++n)if(t(k[e[n]]))return!0}function z(t){if("function"==typeof t){var e;for(e in k)if(t(k[e]))return!0}}t=t||{},void 0===t.uniqueLinkId&&(t.uniqueLinkId=!0);var k="function"==typeof Object.create?Object.create(null):{},N=[],A={},I=0,T=0,S=j(),C=t.uniqueLinkId?p:d,M=[],U=E,D=E,O=E,R=E,B={addNode:u,addLink:l,removeLink:v,removeNode:c,getNode:f,getNodesCount:function(){return I},getLinksCount:function(){return N.length},getLinks:h,forEachNode:S,forEachLinkedNode:x,forEachLink:y,beginUpdate:O,endUpdate:R,clear:m,hasLink:g,getLink:g};return s(B),e(),B}function o(t,e){if(e.indexOf)return e.indexOf(t);var n,r=e.length;for(n=0;n<r;n+=1)if(e[n]===t)return n;return-1}function i(t){this.id=t,this.links=[],this.data=null}function a(t,e,n,r){this.fromId=t,this.toId=e,this.data=n,this.id=r}e.exports=r;var s=t("ngraph.events")},{"ngraph.events":7}],13:[function(t,e,n){function r(t,e){var n;if(t||(t={}),e)for(n in e)if(e.hasOwnProperty(n)){var o=t.hasOwnProperty(n),i=typeof e[n],a=!o||typeof t[n]!==i;a?t[n]=e[n]:"object"===i&&(t[n]=r(t[n],e[n]))}return t}e.exports=r},{}],14:[function(t,e,n){function r(t,e){this.pos=new o(t,e),this.prevPos=new o(t,e),this.force=new o,this.velocity=new o,this.mass=1}function o(t,e){t&&"number"!=typeof t?(this.x="number"==typeof t.x?t.x:0,this.y="number"==typeof t.y?t.y:0):(this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0)}function i(t,e,n){this.pos=new a(t,e,n),this.prevPos=new a(t,e,n),this.force=new a,this.velocity=new a,this.mass=1}function a(t,e,n){t&&"number"!=typeof t?(this.x="number"==typeof t.x?t.x:0,this.y="number"==typeof t.y?t.y:0,this.z="number"==typeof t.z?t.z:0):(this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0,this.z="number"==typeof n?n:0)}e.exports={Body:r,Vector2d:o,Body3d:i,Vector3d:a},r.prototype.setPosition=function(t,e){this.prevPos.x=this.pos.x=t,this.prevPos.y=this.pos.y=e},o.prototype.reset=function(){this.x=this.y=0},i.prototype.setPosition=function(t,e,n){this.prevPos.x=this.pos.x=t,this.prevPos.y=this.pos.y=e,this.prevPos.z=this.pos.z=n},a.prototype.reset=function(){this.x=this.y=this.z=0}},{}],15:[function(t,e,n){function r(e){function n(){var t,e=d.length;if(e)for(h.insertBodies(d);e--;)t=d[e],t.isPinned||(t.force.reset(),h.updateBodyForce(t),m.update(t));for(e=p.length;e--;)g.update(p[e])}var r=t("./lib/spring"),o=t("ngraph.expose"),i=t("ngraph.merge");e=i(e,{springLength:30,springCoeff:8e-4,gravity:-1.2,theta:.8,dragCoeff:.02,timeStep:20,stableThreshold:.009});var a=e.createQuadTree||t("ngraph.quadtreebh"),s=e.createBounds||t("./lib/bounds"),u=e.createDragForce||t("./lib/dragForce"),f=e.createSpringForce||t("./lib/springForce"),c=e.integrator||t("./lib/eulerIntegrator"),l=e.createBody||t("./lib/createBody"),d=[],p=[],h=a(e),v=s(d,e),g=f(e),m=u(e),y={bodies:d,springs:p,settings:e,step:function(){n();var t=c(d,e.timeStep);return v.update(),t<e.stableThreshold},addBody:function(t){if(!t)throw new Error("Body is required");return d.push(t),t},addBodyAt:function(t){if(!t)throw new Error("Body position is required");var e=l(t);return d.push(e),e},removeBody:function(t){if(t){var e=d.indexOf(t);if(!(e<0))return d.splice(e,1),0===d.length&&v.reset(),!0}},addSpring:function(t,e,n,o,i){if(!t||!e)throw new Error("Cannot add null spring to force simulator");"number"!=typeof n&&(n=-1);var a=new r(t,e,n,i>=0?i:-1,o);return p.push(a),a},removeSpring:function(t){if(t){var e=p.indexOf(t);return e>-1?(p.splice(e,1),!0):void 0}},getBestNewBodyPosition:function(t){return v.getBestNewPosition(t)},getBBox:function(){return v.box},gravity:function(t){return void 0!==t?(e.gravity=t,h.options({gravity:t}),this):e.gravity},theta:function(t){return void 0!==t?(e.theta=t,h.options({theta:t}),this):e.theta}};return o(e,y),y}e.exports=r},{"./lib/bounds":16,"./lib/createBody":17,"./lib/dragForce":18,"./lib/eulerIntegrator":19,"./lib/spring":20,"./lib/springForce":21,"ngraph.expose":8,"ngraph.merge":13,"ngraph.quadtreebh":22}],16:[function(t,e,n){e.exports=function(e,n){function r(){var t=e.length;if(0!==t){for(var n=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,a=Number.MIN_VALUE;t--;){var s=e[t];s.isPinned?(s.pos.x=s.prevPos.x,s.pos.y=s.prevPos.y):(s.prevPos.x=s.pos.x,s.prevPos.y=s.pos.y),s.pos.x<n&&(n=s.pos.x),s.pos.x>o&&(o=s.pos.x),s.pos.y<r&&(r=s.pos.y),s.pos.y>a&&(a=s.pos.y)}i.x1=n,i.x2=o,i.y1=r,i.y2=a}}var o=t("ngraph.random").random(42),i={x1:0,y1:0,x2:0,y2:0};return{box:i,update:r,reset:function(){i.x1=i.y1=0,i.x2=i.y2=0},getBestNewPosition:function(t){var e=i,r=0,a=0;if(t.length){for(var s=0;s<t.length;++s)r+=t[s].pos.x,a+=t[s].pos.y;r/=t.length,a/=t.length}else r=(e.x1+e.x2)/2,a=(e.y1+e.y2)/2;var u=n.springLength;return{x:r+o.next(u)-u/2,y:a+o.next(u)-u/2}}}}},{"ngraph.random":26}],17:[function(t,e,n){var r=t("ngraph.physics.primitives");e.exports=function(t){return new r.Body(t)}},{"ngraph.physics.primitives":14}],18:[function(t,e,n){e.exports=function(e){var n=t("ngraph.merge"),r=t("ngraph.expose");e=n(e,{dragCoeff:.02});var o={update:function(t){t.force.x-=e.dragCoeff*t.velocity.x,t.force.y-=e.dragCoeff*t.velocity.y}};return r(e,o,["dragCoeff"]),o}},{"ngraph.expose":8,"ngraph.merge":13}],19:[function(t,e,n){function r(t,e){var n,r=0,o=0,i=0,a=0,s=t.length;for(n=0;n<s;++n){var u=t[n],f=e/u.mass;u.velocity.x+=f*u.force.x,u.velocity.y+=f*u.force.y;var c=u.velocity.x,l=u.velocity.y,d=Math.sqrt(c*c+l*l);d>1&&(u.velocity.x=c/d,u.velocity.y=l/d),r=e*u.velocity.x,i=e*u.velocity.y,u.pos.x+=r,u.pos.y+=i,o+=Math.abs(r),a+=Math.abs(i)}return(o*o+a*a)/t.length}e.exports=r},{}],20:[function(t,e,n){function r(t,e,n,r,o){this.from=t,this.to=e,this.length=n,this.coeff=r,this.weight="number"==typeof o?o:1}e.exports=r},{}],21:[function(t,e,n){e.exports=function(e){var n=t("ngraph.merge"),r=t("ngraph.random").random(42),o=t("ngraph.expose");e=n(e,{springCoeff:2e-4,springLength:80});var i={update:function(t){var n=t.from,o=t.to,i=t.length<0?e.springLength:t.length,a=o.pos.x-n.pos.x,s=o.pos.y-n.pos.y,u=Math.sqrt(a*a+s*s);0===u&&(a=(r.nextDouble()-.5)/50,s=(r.nextDouble()-.5)/50,u=Math.sqrt(a*a+s*s));var f=u-i,c=(!t.coeff||t.coeff<0?e.springCoeff:t.coeff)*f/u*t.weight;n.force.x+=c*a,n.force.y+=c*s,o.force.x-=c*a,o.force.y-=c*s}};return o(e,i,["springCoeff","springLength"]),i}},{"ngraph.expose":8,"ngraph.merge":13,"ngraph.random":26}],22:[function(t,e,n){function r(t,e){return 0===e?t.quad0:1===e?t.quad1:2===e?t.quad2:3===e?t.quad3:null}function o(t,e,n){0===e?t.quad0=n:1===e?t.quad1=n:2===e?t.quad2=n:3===e&&(t.quad3=n)}e.exports=function(e){e=e||{},e.gravity="number"==typeof e.gravity?e.gravity:-1,e.theta="number"==typeof e.theta?e.theta:.8;var n=t("ngraph.random").random(1984),i=t("./node"),a=t("./insertStack"),s=t("./isSamePosition"),u=e.gravity,f=[],c=new a,l=e.theta,d=[],p=0,h=function(){var t=d[p];return t?(t.quad0=null,t.quad1=null,t.quad2=null,t.quad3=null,t.body=null,t.mass=t.massX=t.massY=0,t.left=t.right=t.top=t.bottom=0):(t=new i,d[p]=t),++p,t},v=h(),g=function(t){for(c.reset(),c.push(v,t);!c.isEmpty();){var e=c.pop(),i=e.node,a=e.body;if(i.body){var u=i.body;if(i.body=null,s(u.pos,a.pos)){var f=3;do{var l=n.nextDouble(),d=(i.right-i.left)*l,p=(i.bottom-i.top)*l;u.pos.x=i.left+d,u.pos.y=i.top+p,f-=1}while(f>0&&s(u.pos,a.pos));if(0===f&&s(u.pos,a.pos))return}c.push(i,u),c.push(i,a)}else{var g=a.pos.x,m=a.pos.y;i.mass=i.mass+a.mass,i.massX=i.massX+a.mass*g,i.massY=i.massY+a.mass*m;var y=0,x=i.left,b=(i.right+x)/2,w=i.top,E=(i.bottom+w)/2;if(g>b){y+=1;var _=x;x=b,b+=b-_}if(m>E){y+=2;var L=w;w=E,E+=E-L}var j=r(i,y);j?c.push(j,a):(j=h(),j.left=x,j.top=w,j.right=b,j.bottom=E,j.body=a,o(i,y,j))}}},m=function(t){var e,r,o,i,a=f,s=0,c=0,d=1,p=0,h=1;for(a[0]=v;d;){var g=a[p],m=g.body;d-=1,p+=1;var y=m!==t;m&&y?(r=m.pos.x-t.pos.x,o=m.pos.y-t.pos.y,i=Math.sqrt(r*r+o*o),0===i&&(r=(n.nextDouble()-.5)/50,o=(n.nextDouble()-.5)/50,i=Math.sqrt(r*r+o*o)),e=u*m.mass*t.mass/(i*i*i),s+=e*r,c+=e*o):y&&(r=g.massX/g.mass-t.pos.x,o=g.massY/g.mass-t.pos.y,i=Math.sqrt(r*r+o*o),0===i&&(r=(n.nextDouble()-.5)/50,o=(n.nextDouble()-.5)/50,i=Math.sqrt(r*r+o*o)),(g.right-g.left)/i<l?(e=u*g.mass*t.mass/(i*i*i),s+=e*r,c+=e*o):(g.quad0&&(a[h]=g.quad0,d+=1,h+=1),g.quad1&&(a[h]=g.quad1,d+=1,h+=1),g.quad2&&(a[h]=g.quad2,d+=1,h+=1),g.quad3&&(a[h]=g.quad3,d+=1,h+=1)))}t.force.x+=s,t.force.y+=c},y=function(t){var e,n=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,i=Number.MIN_VALUE,a=t.length;for(e=a;e--;){var s=t[e].pos.x,u=t[e].pos.y;s<n&&(n=s),s>o&&(o=s),u<r&&(r=u),u>i&&(i=u)}var f=o-n,c=i-r;for(f>c?i=r+f:o=n+c,p=0,v=h(),v.left=n,v.right=o,v.top=r,v.bottom=i,e=a-1,e>0&&(v.body=t[e]);e--;)g(t[e],v)};return{insertBodies:y,updateBodyForce:m,options:function(t){return t?("number"==typeof t.gravity&&(u=t.gravity),"number"==typeof t.theta&&(l=t.theta),this):{gravity:u,theta:l}}}}},{"./insertStack":23,"./isSamePosition":24,"./node":25,"ngraph.random":26}],23:[function(t,e,n){function r(){this.stack=[],this.popIdx=0}function o(t,e){this.node=t,this.body=e}e.exports=r,r.prototype={isEmpty:function(){return 0===this.popIdx},push:function(t,e){var n=this.stack[this.popIdx];n?(n.node=t,n.body=e):this.stack[this.popIdx]=new o(t,e),++this.popIdx},pop:function(){if(this.popIdx>0)return this.stack[--this.popIdx]},reset:function(){this.popIdx=0}}},{}],24:[function(t,e,n){e.exports=function(t,e){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n<1e-8&&r<1e-8}},{}],25:[function(t,e,n){e.exports=function(){this.body=null,this.quad0=null,this.quad1=null,this.quad2=null,this.quad3=null,this.mass=0,this.massX=0,this.massY=0,this.left=0,this.top=0,this.bottom=0,this.right=0}},{}],26:[function(t,e,n){function r(t){var e="number"==typeof t?t:+new Date,n=function(){return e=e+2127912214+(e<<12)&4294967295,e=4294967295&(3345072700^e^e>>>19),e=e+374761393+(e<<5)&4294967295,e=4294967295&(e+3550635116^e<<9),e=e+4251993797+(e<<3)&4294967295,e=4294967295&(3042594569^e^e>>>16),(268435455&e)/268435456};return{next:function(t){return Math.floor(n()*t)},nextDouble:function(){return n()}}}function o(t,e){var n=e||r();if("function"!=typeof n.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(e){var r,o,i;for(r=t.length-1;r>0;--r)o=n.next(r+1),i=t[o],t[o]=t[r],t[r]=i,e(i);t.length&&e(t[0])},shuffle:function(){var e,r,o;for(e=t.length-1;e>0;--e)r=n.next(e+1),o=t[r],t[r]=t[e],t[e]=o;return t}}}e.exports={random:r,randomIterator:o}},{}],27:[function(t,e,n){function r(t,e,n){function r(t){s.nodes.push(u(t))}function o(t){s.links.push(f(t))}function i(t){var e={id:t.id};return void 0!==t.data&&(e.data=t.data),e}function a(t){var e={fromId:t.fromId,toId:t.toId};return void 0!==t.data&&(e.data=t.data),e}var s={nodes:[],links:[]},u=e||i,f=n||a;return t.forEachNode(r),t.forEachLink(o),JSON.stringify(s)}e.exports=r},{}],28:[function(t,e,n){function r(t,e){var n=o(t);if(void 0===e)return n;for(var r=Object.keys(e),i=0;i<r.length;++i){var a=r[i],s=e[a];"link"===a?n.link(s):n.attr(a,s)}return n}function o(t){function e(t){return h||(h=i(p)),h.link(t),p}function n(t,e,n){return a.addEventListener(p,t,e,n),p}function o(t,e,n){return a.removeEventListener(p,t,e,n),p}function f(t){var e=r(t);return p.appendChild(e),e}function c(t,e){return 2===arguments.length?(null!==e?p.setAttributeNS(null,t,e):p.removeAttributeNS(null,t),p):p.getAttributeNS(null,t)}function l(t){return arguments.length?(p.setAttributeNS(u,"xlink:href",t),p):p.getAttributeNS(u,"xlink:href")}function d(t){return void 0!==t?(p.textContent=t,p):p.textContent}var p=t;if("string"==typeof t)p=window.document.createElementNS(s,t);else if(t.simplesvg)return t;var h;return p.simplesvg=!0,p.attr=c,p.append=f,p.link=l,p.text=d,p.on=n,p.off=o,p.dataSource=e,p}e.exports=r,r.compile=t("./lib/compile");var i=r.compileTemplate=t("./lib/compile_template"),a=t("add-event-listener"),s="http://www.w3.org/2000/svg",u="http://www.w3.org/1999/xlink"},{"./lib/compile":29,"./lib/compile_template":30,"add-event-listener":2}],29:[function(t,e,n){function r(t){try{return t=o(t),a(i.parseFromString(t,"text/xml").documentElement)}catch(e){throw e}}function o(t){if(t){var e='xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"',n=t.match(/^<\w+/);if(n){var r=n[0].length;return t.substr(0,r)+" "+e+" "+t.substr(r)}throw new Error("Cannot parse input text: invalid xml?")}}var i=t("./domparser.js"),a=t("../");e.exports=r},{"../":28,"./domparser.js":31}],30:[function(t,e,n){function r(t){var e=Object.create(null);return o(t,e),{link:function(t){function n(e){e(t)}Object.keys(e).forEach(function(t){var r=e[t];r.forEach(n)})}}}function o(t,e){var n=t.nodeType,r=1===n||3===n;if(r){var s;if(t.hasChildNodes()){var u=t.childNodes;for(s=0;s<u.length;++s)o(u[s],e)}if(3===n&&a(t,e),t.attributes){var f=t.attributes;for(s=0;s<f.length;++s)i(f[s],t,e)}}}function i(t,e,n){function r(t){e.setAttributeNS(null,a,t[u])}var o=t.value;if(o){var i=o.match(s);if(i){var a=t.localName,u=i[1],f=u.indexOf(".")<0;if(!f)throw new Error("simplesvg currently does not support nested bindings");var c=n[u];c?c.push(r):c=n[u]=[r]}}}function a(t,e){function n(e){t.nodeValue=e[i]}var r=t.nodeValue;if(r){var o=r.match(s);if(o){var i=o[1],a=(i.indexOf(".")<0,e[i]);a?a.push(n):a=e[i]=[n]}}}e.exports=r;var s=/{{(.+?)}}/},{}],31:[function(t,e,n){function r(){return"undefined"==typeof DOMParser?{parseFromString:o}:new DOMParser}function o(){throw new Error("DOMParser is not supported by this platform. Please open issue here https://github.com/anvaka/simplesvg")}e.exports=r()},{}],32:[function(t,e,n){function r(){return{betweennessCentrality:o,degreeCentrality:i}}function o(t){var e=s.betweenness(t);return a(e)}function i(t,e){var n=s.degree(t,e);return a(n)}function a(t){function e(e,n){return t[n]-t[e]}function n(e){return{key:e,value:t[e]}}return Object.keys(t).sort(e).map(n)}var s=t("ngraph.centrality");e.exports=r},{"ngraph.centrality":4}],33:[function(t,e,n){function r(){return{density:function(t,e){var n=t.getNodesCount();return 0===n?NaN:e?t.getLinksCount()/(n*(n-1)):2*t.getLinksCount()/(n*(n-1))}}}e.exports=r},{}],34:[function(t,e,n){function r(t,e){function n(t,n){var i;if(n){var a=e.getNodeUI(t.id);i=o(a),"function"==typeof n.onStart&&i.onStart(n.onStart),"function"==typeof n.onDrag&&i.onDrag(n.onDrag),"function"==typeof n.onStop&&i.onStop(n.onStop),r[t.id]=i}else(i=r[t.id])&&(i.release(),delete r[t.id])}var r={};return{bindDragNDrop:n}}e.exports=r;var o=t("./dragndrop.js")},{"./dragndrop.js":35}],35:[function(t,e,n){function r(t){var e,n,r,s,u,f,c,l=0,d=0,p=!1,h=0,v=function(t){var e=0,n=0;return t=t||window.event,t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+window.document.body.scrollLeft+window.document.documentElement.scrollLeft,n=t.clientY+window.document.body.scrollTop+window.document.documentElement.scrollTop),[e,n]},g=function(t,e,r){n&&n(t,{x:e-l,y:r-d}),l=e,d=r},m=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},y=function(t){t.preventDefault&&t.preventDefault()},x=function(t){return m(t),!1},b=function(t){t=t||window.event,g(t,t.clientX,t.clientY)},w=function(t){if(t=t||window.event,p)return m(t),!1;var n=1===t.button&&null!==window.event||0===t.button;return n?(l=t.clientX,d=t.clientY,c=t.target||t.srcElement,e&&e(t,{x:l,y:d}),o.on("mousemove",b),o.on("mouseup",E),m(t),u=window.document.onselectstart,f=window.document.ondragstart,window.document.onselectstart=x,c.ondragstart=x,!1):void 0},E=function(t){t=t||window.event,o.off("mousemove",b),o.off("mouseup",E),window.document.onselectstart=u,c.ondragstart=f,c=null,r&&r(t)},_=function(e){if("function"==typeof s){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1;var n,r=v(e),o=a(t),i={x:r[0]-o[0],y:r[1]-o[1]};n=e.wheelDelta?e.wheelDelta/360:e.detail/-9,s(e,n,i)}},L=function(e){!s&&e?"webkit"===i.browser?t.addEventListener("mousewheel",_,!1):t.addEventListener("DOMMouseScroll",_,!1):s&&!e&&("webkit"===i.browser?t.removeEventListener("mousewheel",_,!1):t.removeEventListener("DOMMouseScroll",_,!1)),s=e},j=function(t,e){return(t.clientX-e.clientX)*(t.clientX-e.clientX)+(t.clientY-e.clientY)*(t.clientY-e.clientY)},P=function(t){if(1===t.touches.length){m(t);var e=t.touches[0];g(t,e.clientX,e.clientY)}else if(2===t.touches.length){var n=j(t.touches[0],t.touches[1]),r=0;n<h?r=-1:n>h&&(r=1),s(t,r,{x:t.touches[0].clientX,y:t.touches[0].clientY}),h=n,m(t),y(t)}},z=function(t){p=!1,o.off("touchmove",P),o.off("touchend",z),o.off("touchcancel",z),c=null,r&&r(t)},k=function(t,n){m(t),y(t),l=n.clientX,d=n.clientY,c=t.target||t.srcElement,e&&e(t,{x:l,y:d}),p||(p=!0,o.on("touchmove",P),o.on("touchend",z),o.on("touchcancel",z))},N=function(t){return 1===t.touches.length?k(t,t.touches[0]):void(2===t.touches.length&&(m(t),y(t),h=j(t.touches[0],t.touches[1])))};return t.addEventListener("mousedown",w),t.addEventListener("touchstart",N),{onStart:function(t){return e=t,this},onDrag:function(t){
return n=t,this},onStop:function(t){return r=t,this},onScroll:function(t){return L(t),this},release:function(){t.removeEventListener("mousedown",w),t.removeEventListener("touchstart",N),o.off("mousemove",b),o.off("mouseup",E),o.off("touchmove",P),o.off("touchend",z),o.off("touchcancel",z),L(null)}}}e.exports=r;var o=t("../Utils/documentEvents.js"),i=t("../Utils/browserInfo.js"),a=t("../Utils/findElementPosition.js")},{"../Utils/browserInfo.js":40,"../Utils/documentEvents.js":41,"../Utils/findElementPosition.js":42}],36:[function(t,e,n){function r(t,e){var n=o(e),r=null,i={},a={x:0,y:0};return n.mouseDown(function(t,e){r=t,a.x=e.clientX,a.y=e.clientY,n.mouseCapture(r);var o=i[t.id];return o&&o.onStart&&o.onStart(e,a),!0}).mouseUp(function(t){n.releaseMouseCapture(r),r=null;var e=i[t.id];return e&&e.onStop&&e.onStop(),!0}).mouseMove(function(t,e){if(r){var n=i[r.id];return n&&n.onDrag&&n.onDrag(e,{x:e.clientX-a.x,y:e.clientY-a.y}),a.x=e.clientX,a.y=e.clientY,!0}}),{bindDragNDrop:function(t,e){i[t.id]=e,e||delete i[t.id]}}}e.exports=r;var o=t("../WebGL/webglInputEvents.js")},{"../WebGL/webglInputEvents.js":60}],37:[function(t,e,n){function r(t,e){function n(t){return l[t]}e=o(e,{maxX:1024,maxY:1024,seed:"Deterministic randomness made me do this"});var r=i(e.seed),s=new a(Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),u={},f=function(t){return{x:r.next(e.maxX),y:r.next(e.maxY)}},c=function(t,e){t.x<e.x1&&(e.x1=t.x),t.x>e.x2&&(e.x2=t.x),t.y<e.y1&&(e.y1=t.y),t.y>e.y2&&(e.y2=t.y)},l="function"==typeof Object.create?Object.create(null):{},d=function(t){l[t.id]=f(t),c(l[t.id],s)},p=function(){0!==t.getNodesCount()&&(s.x1=Number.MAX_VALUE,s.y1=Number.MAX_VALUE,s.x2=Number.MIN_VALUE,s.y2=Number.MIN_VALUE,t.forEachNode(d))},h=function(t){u[t.id]=t},v=function(t){for(var e=0;e<t.length;++e){var n=t[e];n.node&&("add"===n.changeType?d(n.node):delete l[n.node.id]),n.link&&("add"===n.changeType?h(n.link):delete u[n.link.id])}};return t.forEachNode(d),t.forEachLink(h),t.on("changed",v),{run:function(t){this.step()},step:function(){return p(),!0},getGraphRect:function(){return s},dispose:function(){t.off("change",v)},isNodePinned:function(t){return!0},pinNode:function(t,e){},getNodePosition:n,getLinkPosition:function(t){var e=u[t];return{from:n(e.fromId),to:n(e.toId)}},setNodePosition:function(t,e,n){var r=l[t];r&&(r.x=e,r.y=n)},placeNode:function(t){return"function"==typeof t?(f=t,p(),this):f(t)}}}e.exports=r;var o=t("ngraph.merge"),i=t("ngraph.random").random,a=t("../Utils/rect.js")},{"../Utils/rect.js":47,"ngraph.merge":13,"ngraph.random":26}],38:[function(t,e,n){function r(t){function e(){var e=o(t);return e.addEventListener=e.on,e}if(console.log("This method is deprecated. Please use Viva.events() instead"),!t)return t;var n=void 0!==t.on||void 0!==t.off||void 0!==t.fire;return n?{extend:function(){return t},on:t.on,stop:t.off}:{extend:e,on:t.on,stop:t.off}}var o=t("ngraph.events");e.exports=r},{"ngraph.events":7}],39:[function(t,e,n){!function(){"use strict";function n(t,e,n,r,o){"undefined"==typeof o&&(o=.5);var i=c.projectionratio(o,t),a=1-i,s={x:i*e.x+a*r.x,y:i*e.y+a*r.y},u=c.abcratio(o,t),f={x:n.x+(n.x-s.x)/u,y:n.y+(n.y-s.y)/u};return{A:f,B:n,C:s}}var r=Math.abs,o=Math.min,i=Math.max,a=Math.acos,s=Math.sqrt,u=Math.PI,f={x:0,y:0,z:0},c=t("./utils.js"),l=t("./poly-bezier.js"),d=function(t){var e=t&&t.forEach?t:[].slice.call(arguments),n=!1;if("object"==typeof e[0]){n=e.length;var o=[];e.forEach(function(t){["x","y","z"].forEach(function(e){"undefined"!=typeof t[e]&&o.push(t[e])})}),e=o}var i=!1,a=e.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(6!==a&&8!==a&&9!==a&&12!==a&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var s=!i&&(9===a||12===a)||t&&t[0]&&"undefined"!=typeof t[0].z;this._3d=s;for(var u=[],f=0,l=s?3:2;f<a;f+=l){var d={x:e[f],y:e[f+1]};s&&(d.z=e[f+2]),u.push(d)}this.order=u.length-1,this.points=u;var p=["x","y"];s&&p.push("z"),this.dims=p,this.dimlen=p.length,function(t){for(var e=t.order,n=t.points,o=c.align(n,{p1:n[0],p2:n[e]}),i=0;i<o.length;i++)if(r(o[i].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()};d.fromSVG=function(t){var e=t.match(/[-+]?\d*\.?\d+(?:[eE][-+]?\d+)?/g).map(parseFloat),n=/[cq]/.test(t);return n?(e=e.map(function(t,n){return n<2?t:t+e[n%2]}),new d(e)):new d(e)},d.quadraticFromPoints=function(t,e,r,o){if("undefined"==typeof o&&(o=.5),0===o)return new d(e,e,r);if(1===o)return new d(t,e,e);var i=n(2,t,e,r,o);return new d(t,i.A,r)},d.cubicFromPoints=function(t,e,r,o,i){"undefined"==typeof o&&(o=.5);var a=n(3,t,e,r,o);"undefined"==typeof i&&(i=c.dist(e,a.C));var s=i*(1-o)/o,u=c.dist(t,r),f=(r.x-t.x)/u,l=(r.y-t.y)/u,p=i*f,h=i*l,v=s*f,g=s*l,m={x:e.x-p,y:e.y-h},y={x:e.x+v,y:e.y+g},x=a.A,b={x:x.x+(m.x-x.x)/(1-o),y:x.y+(m.y-x.y)/(1-o)},w={x:x.x+(y.x-x.x)/o,y:x.y+(y.y-x.y)/o},E={x:t.x+(b.x-t.x)/o,y:t.y+(b.y-t.y)/o},_={x:r.x+(w.x-r.x)/(1-o),y:r.y+(w.y-r.y)/(1-o)};return new d(t,E,_,r)};var p=function(){return c};d.getUtils=p,d.prototype={getUtils:p,valueOf:function(){return this.toString()},toString:function(){return c.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,n=e[0].x,r=e[0].y,o=["M",n,r,2===this.order?"Q":"C"],i=1,a=e.length;i<a;i++)o.push(e[i].x),o.push(e[i].y);return o.join(" ")},update:function(){this.dpoints=[];for(var t=this.points,e=t.length,n=e-1;e>1;e--,n--){for(var r,o=[],i=0;i<n;i++)r={x:n*(t[i+1].x-t[i].x),y:n*(t[i+1].y-t[i].y)},this._3d&&(r.z=n*(t[i+1].z-t[i].z)),o.push(r);this.dpoints.push(o),t=o}this.computedirection()},computedirection:function(){var t=this.points,e=c.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return c.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(t=t||100,this._lut.length===t)return this._lut;this._lut=[];for(var e=0;e<=t;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var n,r=this.getLUT(),o=[],i=0,a=0;a<r.length;a++)n=r[a],c.dist(n,t)<e&&(o.push(n),i+=a/r.length);return!!o.length&&(i/=o.length)},project:function(t){var e=this.getLUT(),n=e.length-1,r=c.closest(e,t),o=r.mdist,i=r.mpos;if(0===i||i===n){var a=i/n,s=this.compute(a);return s.t=a,s.d=o,s}var u,a,f,l,d=(i-1)/n,p=(i+1)/n,h=.1/n;for(o+=1,a=d,u=a;a<p+h;a+=h)f=this.compute(a),l=c.dist(t,f),l<o&&(o=l,u=a);return f=this.compute(u),f.t=u,f.d=o,f},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){if(0===t)return this.points[0];if(1===t)return this.points[this.order];var e=this.points,n=1-t;if(1===this.order)return c={x:n*e[0].x+t*e[1].x,y:n*e[0].y+t*e[1].y},this._3d&&(c.z=n*e[0].z+t*e[1].z),c;if(this.order<4){var r,o,i,a=n*n,s=t*t,u=0;2===this.order?(e=[e[0],e[1],e[2],f],r=a,o=n*t*2,i=s):3===this.order&&(r=a*n,o=a*t*3,i=n*s*3,u=t*s);var c={x:r*e[0].x+o*e[1].x+i*e[2].x+u*e[3].x,y:r*e[0].y+o*e[1].y+i*e[2].y+u*e[3].y};return this._3d&&(c.z=r*e[0].z+o*e[1].z+i*e[2].z+u*e[3].z),c}for(var l=JSON.parse(JSON.stringify(this.points));l.length>1;){for(var d=0;d<l.length-1;d++)l[d]={x:l[d].x+(l[d+1].x-l[d].x)*t,y:l[d].y+(l[d+1].y-l[d].y)*t},"undefined"!=typeof l[d].z&&(l[d]=l[d].z+(l[d+1].z-l[d].z)*t);l.splice(l.length-1,1)}return l[0]},raise:function(){for(var t,e,n,r=this.points,o=[r[0]],i=r.length,t=1;t<i;t++)e=r[t],n=r[t-1],o[t]={x:(i-t)/i*e.x+t/i*n.x,y:(i-t)/i*e.y+t/i*n.y};return o[i]=r[i-1],new d(o)},derivative:function(t){var e,n,r=1-t,o=0,i=this.dpoints[0];2===this.order&&(i=[i[0],i[1],f],e=r,n=t),3===this.order&&(e=r*r,n=r*t*2,o=t*t);var a={x:e*i[0].x+n*i[1].x+o*i[2].x,y:e*i[0].y+n*i[1].y+o*i[2].y};return this._3d&&(a.z=e*i[0].z+n*i[1].z+o*i[2].z),a},inflections:function(){return c.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),n=s(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}},__normal3:function(t){var e=this.derivative(t),n=this.derivative(t+.01),r=s(e.x*e.x+e.y*e.y+e.z*e.z),o=s(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=r,e.y/=r,e.z/=r,n.x/=o,n.y/=o,n.z/=o;var i={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},a=s(i.x*i.x+i.y*i.y+i.z*i.z);i.x/=a,i.y/=a,i.z/=a;var u=[i.x*i.x,i.x*i.y-i.z,i.x*i.z+i.y,i.x*i.y+i.z,i.y*i.y,i.y*i.z-i.x,i.x*i.z-i.y,i.y*i.z+i.x,i.z*i.z],f={x:u[0]*e.x+u[1]*e.y+u[2]*e.z,y:u[3]*e.x+u[4]*e.y+u[5]*e.z,z:u[6]*e.x+u[7]*e.y+u[8]*e.z};return f},hull:function(t){var e,n=this.points,r=[],o=[],i=0,a=0,s=0;for(o[i++]=n[0],o[i++]=n[1],o[i++]=n[2],3===this.order&&(o[i++]=n[3]);n.length>1;){for(r=[],a=0,s=n.length-1;a<s;a++)e=c.lerp(t,n[a],n[a+1]),o[i++]=e,r.push(e);n=r}return o},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var n=this.hull(t),r={left:new d(2===this.order?[n[0],n[3],n[5]]:[n[0],n[4],n[7],n[9]]),right:new d(2===this.order?[n[5],n[4],n[2]]:[n[9],n[8],n[6],n[3]]),span:n};if(r.left._t1=c.map(0,0,1,this._t1,this._t2),r.left._t2=c.map(t,0,1,this._t1,this._t2),r.right._t1=c.map(t,0,1,this._t1,this._t2),r.right._t2=c.map(1,0,1,this._t1,this._t2),!e)return r;e=c.map(e,t,1,0,1);var o=r.right.split(e);return o.left},extrema:function(){var t,e,n=this.dims,r={},o=[];return n.forEach(function(n){e=function(t){return t[n]},t=this.dpoints[0].map(e),r[n]=c.droots(t),3===this.order&&(t=this.dpoints[1].map(e),r[n]=r[n].concat(c.droots(t))),r[n]=r[n].filter(function(t){return t>=0&&t<=1}),o=o.concat(r[n].sort())}.bind(this)),o=o.sort().filter(function(t,e){return o.indexOf(t)===e}),r.values=o,r},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=c.getminmax(this,n,t[n])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),n=t.bbox();return c.bboxoverlap(e,n)},offset:function(t,e){if("undefined"!=typeof e){var n=this.get(t),r=this.normal(t),o={c:n,n:r,x:n.x+r.x*e,y:n.y+r.y*e};return this._3d&&(o.z=n.z+r.z*e),o}if(this._linear){var i=this.normal(0),a=this.points.map(function(e){var n={x:e.x+t*i.x,y:e.y+t*i.y};return e.z&&r.z&&(n.z=e.z+t*i.z),n});return[new d(a)]}var s=this.reduce();return s.map(function(e){return e.scale(t)})},simple:function(){if(3===this.order){var t=c.angle(this.points[0],this.points[3],this.points[1]),e=c.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}var n=this.normal(0),o=this.normal(1),i=n.x*o.x+n.y*o.y;this._3d&&(i+=n.z*o.z);var s=r(a(i));return s<u/3},reduce:function(){var t,e,n=0,o=0,i=.01,a=[],s=[],u=this.extrema().values;for(u.indexOf(0)===-1&&(u=[0].concat(u)),u.indexOf(1)===-1&&u.push(1),n=u[0],t=1;t<u.length;t++)o=u[t],e=this.split(n,o),e._t1=n,e._t2=o,a.push(e),n=o;return a.forEach(function(t){for(n=0,o=0;o<=1;)for(o=n+i;o<=1+i;o+=i)if(e=t.split(n,o),!e.simple()){if(o-=i,r(n-o)<i)return[];e=t.split(n,o),e._t1=c.map(n,0,1,t._t1,t._t2),e._t2=c.map(o,0,1,t._t1,t._t2),s.push(e),n=o;break}n<1&&(e=t.split(n,1),e._t1=c.map(n,0,1,t._t1,t._t2),e._t2=t._t2,s.push(e))}),s},scale:function(t){var e=this.order,n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);var r=this.clockwise,o=n?n(0):t,i=n?n(1):t,a=[this.offset(0,10),this.offset(1,10)],u=c.lli4(a[0],a[0].c,a[1],a[1].c);if(!u)throw new Error("cannot scale this curve. Try reducing it first.");var f=this.points,l=[];return[0,1].forEach(function(t){var n=l[t*e]=c.copy(f[t*e]);n.x+=(t?i:o)*a[t].n.x,n.y+=(t?i:o)*a[t].n.y}.bind(this)),n?([0,1].forEach(function(o){if(2!==this.order||!o){var i=f[o+1],a={x:i.x-u.x,y:i.y-u.y},c=n?n((o+1)/e):t;n&&!r&&(c=-c);var d=s(a.x*a.x+a.y*a.y);a.x/=d,a.y/=d,l[o+1]={x:i.x+c*a.x,y:i.y+c*a.y}}}.bind(this)),new d(l)):([0,1].forEach(function(t){if(2!==this.order||!t){var n=l[t*e],r=this.derivative(t),o={x:n.x+r.x,y:n.y+r.y};l[t+1]=c.lli4(n,o,u,f[t+1])}}.bind(this)),new d(l))},outline:function(t,e,n,r){function o(t,e,n,r,o){return function(i){var a=r/n,s=(r+o)/n,u=e-t;return c.map(i,0,1,t+a*u,t+s*u)}}e="undefined"==typeof e?t:e;var i,a=this.reduce(),s=a.length,u=[],f=[],d=0,p=this.length(),h="undefined"!=typeof n&&"undefined"!=typeof r;a.forEach(function(i){E=i.length(),h?(u.push(i.scale(o(t,n,p,d,E))),f.push(i.scale(o(-e,-r,p,d,E)))):(u.push(i.scale(t)),f.push(i.scale(-e))),d+=E}),f=f.map(function(t){return i=t.points,i[3]?t.points=[i[3],i[2],i[1],i[0]]:t.points=[i[2],i[1],i[0]],t}).reverse();var v=u[0].points[0],g=u[s-1].points[u[s-1].points.length-1],m=f[s-1].points[f[s-1].points.length-1],y=f[0].points[0],x=c.makeline(m,v),b=c.makeline(g,y),w=[x].concat(u).concat([b]).concat(f),E=w.length;return new l(w)},outlineshapes:function(t,e,n){e=e||t;for(var r=this.outline(t,e).curves,o=[],i=1,a=r.length;i<a/2;i++){var s=c.makeshape(r[i],r[a-i],n);s.startcap.virtual=i>1,s.endcap.virtual=i<a/2-1,o.push(s)}return o},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof d&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=o(t.p1.x,t.p2.x),n=o(t.p1.y,t.p2.y),r=i(t.p1.x,t.p2.x),a=i(t.p1.y,t.p2.y),s=this;return c.roots(this.points,t).filter(function(t){var o=s.get(t);return c.between(o.x,e,r)&&c.between(o.y,n,a)})},selfintersects:function(t){var e,n,r,o,i=this.reduce(),a=i.length-2,s=[];for(e=0;e<a;e++)r=i.slice(e,e+1),o=i.slice(e+2),n=this.curveintersects(r,o,t),s=s.concat(n);return s},curveintersects:function(t,e,n){var r=[];t.forEach(function(t){e.forEach(function(e){t.overlaps(e)&&r.push({left:t,right:e})})});var o=[];return r.forEach(function(t){var e=c.pairiteration(t.left,t.right,n);e.length>0&&(o=o.concat(e))}),o},arcs:function(t){t=t||.5;var e=[];return this._iterate(t,e)},_error:function(t,e,n,o){var i=(o-n)/4,a=this.get(n+i),s=this.get(o-i),u=c.dist(t,e),f=c.dist(t,a),l=c.dist(t,s);return r(f-u)+r(l-u)},_iterate:function(t,e){var n,r=0,o=1;do{n=0,o=1;var i,a,s,u,f,l=this.get(r),d=!1,p=!1,h=o,v=1,g=0;do{p=d,u=s,h=(r+o)/2,g++,i=this.get(h),a=this.get(o),s=c.getccenter(l,i,a),s.interval={start:r,end:o};var m=this._error(s,l,r,o);if(d=m<=t,f=p&&!d,f||(v=o),d){if(o>=1){v=1,u=s;break}o+=(o-r)/2}else o=h}while(!f&&n++<100);if(n>=100){console.error("arc abstraction somehow failed...");break}u=u?u:s,e.push(u),r=v}while(o<1);return e}},e.exports=d}()},{"./poly-bezier.js":46,"./utils.js":49}],40:[function(t,e,n){function r(){if("undefined"==typeof window||!window.hasOwnProperty("navigator"))return{browser:"",version:"0"};var t=window.navigator.userAgent.toLowerCase(),e=/(webkit)[ \/]([\w.]+)/,n=/(opera)(?:.*version)?[ \/]([\w.]+)/,r=/(msie) ([\w.]+)/,o=/(mozilla)(?:.*? rv:([\w.]+))?/,i=e.exec(t)||n.exec(t)||r.exec(t)||t.indexOf("compatible")<0&&o.exec(t)||[];return{browser:i[1]||"",version:i[2]||"0"}}e.exports=r()},{}],41:[function(t,e,n){function r(){return void 0===typeof document?a:{on:o,off:i}}function o(t,e){document.addEventListener(t,e)}function i(t,e){document.removeEventListener(t,e)}var a=t("./nullEvents.js");e.exports=r()},{"./nullEvents.js":45}],42:[function(t,e,n){function r(t){var e=0,n=0;if(t.offsetParent)do e+=t.offsetLeft,n+=t.offsetTop;while(null!==(t=t.offsetParent));return[e,n]}e.exports=r},{}],43:[function(t,e,n){function r(t){if(!t)throw{message:"Cannot get dimensions of undefined container"};var e=t.clientWidth,n=t.clientHeight;return{left:0,top:0,width:e,height:n}}e.exports=r},{}],44:[function(t,e,n){function r(t,e,n,r,i,a,s,u){return o(t,e,t,r,i,a,s,u)||o(t,r,n,r,i,a,s,u)||o(n,r,n,e,i,a,s,u)||o(n,e,t,e,i,a,s,u)}var o=t("gintersect");e.exports=r},{gintersect:3}],45:[function(t,e,n){function r(){return{on:o,off:o,stop:o}}function o(){}e.exports=r()},{}],46:[function(t,e,n){!function(){"use strict";var n=t("./utils.js"),r=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};r.prototype={valueOf:function(){return this.toString()},toString:function(){return n.pointsToString(this.points)},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map(function(t){return t.length()}).reduce(function(t,e){return t+e})},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,e=t[0].bbox(),r=1;r<t.length;r++)n.expandbox(e,t[r].bbox());return e},offset:function(t){var e=[];return this.curves.forEach(function(n){e=e.concat(n.offset(t))}),new r(e)}},e.exports=r}()},{"./utils.js":49}],47:[function(t,e,n){function r(t,e,n,r){this.x1=t||0,this.y1=e||0,this.x2=n||0,this.y2=r||0}e.exports=r},{}],48:[function(t,e,n){(function(t){function n(){function e(t){function e(){o=a.requestAnimationFrame(e),t()||n()}function n(){a.cancelAnimationFrame(o),o=0}function r(){o||e()}var o;return e(),{stop:n,restart:r}}function n(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-s)),r=a.setTimeout(function(){t(e+n)},n);return s=e+n,r}function o(t){a.clearTimeout(t)}var i,a,s=0,u=["ms","moz","webkit","o"];for(a="undefined"!=typeof window?window:"undefined"!=typeof t?t:{setTimeout:r,clearTimeout:r},i=0;i<u.length&&!a.requestAnimationFrame;++i){var f=u[i];a.requestAnimationFrame=a[f+"RequestAnimationFrame"],a.cancelAnimationFrame=a[f+"CancelAnimationFrame"]||a[f+"CancelRequestAnimationFrame"]}return a.requestAnimationFrame||(a.requestAnimationFrame=n),a.cancelAnimationFrame||(a.cancelAnimationFrame=o),e}function r(){}e.exports=n()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(t,e,n){!function(){"use strict";var n=Math.abs,r=Math.cos,o=Math.sin,i=Math.acos,a=Math.atan2,s=Math.sqrt,u=Math.pow,f=function(t){return t<0?-u(-t,1/3):u(t,1/3)},c=Math.PI,l=2*c,d=c/2,p=1e-6,h={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var n=e(t),r=n.x*n.x+n.y*n.y;return"undefined"!=typeof n.z&&(r+=n.z*n.z),s(r)},between:function(t,e,n){return e<=t&&t<=n||h.approximately(t,e)||h.approximately(t,n)},approximately:function(t,e,r){return n(t-e)<=(r||p)},length:function(t){var e,n,r=.5,o=0,i=h.Tvalues.length;for(e=0;e<i;e++)n=r*h.Tvalues[e]+r,o+=h.Cvalues[e]*h.arcfn(n,t);return r*o},map:function(t,e,n,r,o){var i=n-e,a=o-r,s=t-e,u=s/i;return r+a*u},lerp:function(t,e,n){var r={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return e.z&&n.z&&(r.z=e.z+t*(n.z-e.z)),r},pointToString:function(t){var e=t.x+"/"+t.y;return"undefined"!=typeof t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(h.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){var r,o=e.x-t.x,i=e.y-t.y,u=n.x-t.x,f=n.y-t.y,c=o*f-i*u,l=s(o*o+i*i),d=s(u*u+f*f);return o/=l,i/=l,u/=d,f/=d,r=o*u+i*f,a(c,r)},round:function(t,e){var n=""+t,r=n.indexOf(".");return parseFloat(n.substring(0,r+1+e))},dist:function(t,e){var n=t.x-e.x,r=t.y-e.y;return s(n*n+r*r)},closest:function(t,e){var n,r,o=u(2,63);return t.forEach(function(t,i){r=h.dist(e,t),r<o&&(o=r,n=i)}),{mdist:o,mpos:n}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if("undefined"==typeof t)t=.5;else if(0===t||1===t)return t;var r=u(t,e)+u(1-t,e),o=r-1;return n(o/r)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if("undefined"==typeof t)t=.5;else if(0===t||1===t)return t;var n=u(1-t,e),r=u(t,e)+n;return n/r},lli8:function(t,e,n,r,o,i,a,s){var u=(t*r-e*n)*(o-a)-(t-n)*(o*s-i*a),f=(t*r-e*n)*(i-s)-(e-r)*(o*s-i*a),c=(t-n)*(i-s)-(e-r)*(o-a);return 0!=c&&{x:u/c,y:f/c}},lli4:function(t,e,n,r){var o=t.x,i=t.y,a=e.x,s=e.y,u=n.x,f=n.y,c=r.x,l=r.y;return h.lli8(o,i,a,s,u,f,c,l)},lli:function(t,e){return h.lli4(t,t.c,e,e.c)},makeline:function(e,n){var r=t("./bezier"),o=e.x,i=e.y,a=n.x,s=n.y,u=(a-o)/3,f=(s-i)/3;return new r(o,i,o+u,i+f,o+2*u,i+2*f,a,s)},findbbox:function(t){var e=99999999,n=e,r=-e,o=r;return t.forEach(function(t){var i=t.bbox();e>i.x.min&&(e=i.x.min),n>i.y.min&&(n=i.y.min),r<i.x.max&&(r=i.x.max),o<i.y.max&&(o=i.y.max)}),{x:{min:e,mid:(e+r)/2,max:r,size:r-e},y:{min:n,mid:(n+o)/2,max:o,size:o-n}}},shapeintersections:function(t,e,n,r,o){if(!h.bboxoverlap(e,r))return[];var i=[],a=[t.startcap,t.forward,t.back,t.endcap],s=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(e){e.virtual||s.forEach(function(r){if(!r.virtual){var a=e.intersects(r,o);a.length>0&&(a.c1=e,a.c2=r,a.s1=t,a.s2=n,i.push(a))}})}),i},makeshape:function(t,e,n){var r=e.points.length,o=t.points.length,i=h.makeline(e.points[r-1],t.points[0]),a=h.makeline(t.points[o-1],e.points[0]),s={startcap:i,forward:t,back:e,endcap:a,bbox:h.findbbox([i,t,e,a])},u=h;return s.intersections=function(t){return u.shapeintersections(s,s.bbox,t,t.bbox,n)},s},getminmax:function(t,e,n){if(!n)return{min:0,max:0};var r,o,i=0x10000000000000000,a=-i;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(var s=0,u=n.length;s<u;s++)r=n[s],o=t.get(r),o[e]<i&&(i=o[e]),o[e]>a&&(a=o[e]);return{min:i,mid:(i+a)/2,max:a,size:a-i}},align:function(t,e){var n=e.p1.x,i=e.p1.y,s=-a(e.p2.y-i,e.p2.x-n),u=function(t){return{x:(t.x-n)*r(s)-(t.y-i)*o(s),y:(t.x-n)*o(s)+(t.y-i)*r(s)}};return t.map(u)},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var n=t.length-1,o=h.align(t,e),a=function(t){return 0<=t&&t<=1};if(2===n){var u=o[0].y,c=o[1].y,d=o[2].y,p=u-2*c+d;if(0!==p){var v=-s(c*c-u*d),g=-u+c,m=-(v+g)/p,y=-(-v+g)/p;return[m,y].filter(a)}return c!==d&&0===p?[(2*c-d)/2*(c-d)].filter(a):[]}var x,m,b,w,E,_=o[0].y,L=o[1].y,j=o[2].y,P=o[3].y,p=-_+3*L-3*j+P,u=(3*_-6*L+3*j)/p,c=(-3*_+3*L)/p,d=_/p,o=(3*c-u*u)/3,z=o/3,k=(2*u*u*u-9*u*c+27*d)/27,N=k/2,A=N*N+z*z*z;if(A<0){var I=-o/3,T=I*I*I,S=s(T),C=-k/(2*S),M=C<-1?-1:C>1?1:C,U=i(M),D=f(S),O=2*D;return b=O*r(U/3)-u/3,w=O*r((U+l)/3)-u/3,E=O*r((U+2*l)/3)-u/3,[b,w,E].filter(a)}if(0===A)return x=N<0?f(-N):-f(N),b=2*x-u/3,w=-x-u/3,[b,w].filter(a);var R=s(A);return x=f(-N+R),m=f(N+R),[x-m-u/3].filter(a)},droots:function(t){if(3===t.length){var e=t[0],n=t[1],r=t[2],o=e-2*n+r;if(0!==o){var i=-s(n*n-e*r),a=-e+n,u=-(i+a)/o,f=-(-i+a)/o;return[u,f]}return n!==r&&0===o?[(2*n-r)/(2*(n-r))]:[]}if(2===t.length){var e=t[0],n=t[1];return e!==n?[e/(e-n)]:[]}},inflections:function(t){if(t.length<4)return[];var e=h.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,r=e[3].x*e[1].y,o=e[1].x*e[2].y,i=e[3].x*e[2].y,a=18*(-3*n+2*r+3*o-i),s=18*(3*n-r-3*o),u=18*(o-n);if(h.approximately(a,0))return[];var f=s*s-4*a*u,c=Math.sqrt(f),i=2*a;return h.approximately(i,0)?[]:[(c-s)/i,-(s+c)/i].filter(function(t){return 0<=t&&t<=1})},bboxoverlap:function(t,e){var r,o,i,a,s,u=["x","y"],f=u.length;for(r=0;r<f;r++)if(o=u[r],i=t[o].mid,a=e[o].mid,s=(t[o].size+e[o].size)/2,n(i-a)>=s)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){var r=t.bbox(),o=e.bbox(),i=1e5,a=n||.5;if(r.x.size+r.y.size<a&&o.x.size+o.y.size<a)return[(i*(t._t1+t._t2)/2|0)/i+"/"+(i*(e._t1+e._t2)/2|0)/i];var s=t.split(.5),u=e.split(.5),f=[{left:s.left,right:u.left},{left:s.left,right:u.right},{left:s.right,right:u.right},{left:s.right,right:u.left}];f=f.filter(function(t){return h.bboxoverlap(t.left.bbox(),t.right.bbox())});var c=[];return 0===f.length?c:(f.forEach(function(t){c=c.concat(h.pairiteration(t.left,t.right,a))}),c=c.filter(function(t,e){return c.indexOf(t)===e}))},getccenter:function(t,e,n){var i,s=e.x-t.x,u=e.y-t.y,f=n.x-e.x,c=n.y-e.y,p=s*r(d)-u*o(d),v=s*o(d)+u*r(d),g=f*r(d)-c*o(d),m=f*o(d)+c*r(d),y=(t.x+e.x)/2,x=(t.y+e.y)/2,b=(e.x+n.x)/2,w=(e.y+n.y)/2,E=y+p,_=x+v,L=b+g,j=w+m,P=h.lli8(y,x,E,_,b,w,L,j),z=h.dist(P,t),k=a(t.y-P.y,t.x-P.x),N=a(e.y-P.y,e.x-P.x),A=a(n.y-P.y,n.x-P.x);return k<A?((k>N||N>A)&&(k+=l),k>A&&(i=A,A=k,k=i)):A<N&&N<k?(i=A,A=k,k=i):A+=l,P.s=k,P.e=A,P.r=z,P}};e.exports=h}()},{"./bezier":39}],50:[function(t,e,n){function r(){return void 0===typeof window?a:{on:o,off:i}}function o(t,e){window.addEventListener(t,e)}function i(t,e){window.removeEventListener(t,e)}var a=t("./nullEvents.js");e.exports=r()},{"./nullEvents.js":45}],51:[function(t,e,n){function r(t,e){function n(t){return"string"==typeof G?G.indexOf(t)>=0:"boolean"!=typeof G||G}function r(){F=F||window.document.body,R=R||i(t,{springLength:80,springCoeff:2e-4}),B=B||a(t,{container:F}),e.hasOwnProperty("renderLinks")||(e.renderLinks=!0),e.prerender=e.prerender||0,U=(B.inputManager||u)(t,B)}function d(){B.beginRender(),e.renderLinks&&B.renderLinks(),B.renderNodes(),B.endRender()}function p(){return W=R.step()&&!J,d(),!W}function h(t){return D?void(V+=t):void(t?(V+=t,D=f(function(){return p()},M)):(X=0,V=0,D=f(p,M)))}function v(){H||(W=!1,D.restart())}function g(){if("number"==typeof e.prerender&&e.prerender>0)for(var t=0;t<e.prerender;t+=1)R.step()}function m(){var t=R.getGraphRect(),e=c(F),n=(t.x2+t.x1)/2,r=(t.y2+t.y1)/2;Q.offsetX=e.width/2-(n*Q.scale-n),Q.offsetY=e.height/2-(r*Q.scale-r),B.graphCenterChanged(Q.offsetX,Q.offsetY),Y=!1}function y(t){var e=R.getNodePosition(t.id);B.addNode(t,e)}function x(t){B.releaseNode(t)}function b(t){var e=R.getLinkPosition(t.id);B.addLink(t,e)}function w(t){B.releaseLink(t)}function E(t){if(n("node")){var e=!1;U.bindDragNDrop(t,{onStart:function(){e=R.isNodePinned(t),R.pinNode(t,!0),J=!0,v()},onDrag:function(e,n){var r=R.getNodePosition(t.id);R.setNodePosition(t.id,r.x+n.x/Q.scale,r.y+n.y/Q.scale),J=!0,d()},onStop:function(){R.pinNode(t,e),J=!1}})}}function _(t){U.bindDragNDrop(t,null)}function L(){B.init(F),t.forEachNode(y),e.renderLinks&&t.forEachLink(b)}function j(){B.release(F)}function P(e){var n=e.node;"add"===e.changeType?(y(n),E(n),Y&&m()):"remove"===e.changeType?(_(n),x(n),0===t.getNodesCount()&&(Y=!0)):"update"===e.changeType&&(_(n),x(n),y(n),E(n))}function z(t){var n=t.link;if("add"===t.changeType)e.renderLinks&&b(n);else if("remove"===t.changeType)e.renderLinks&&w(n);else if("update"===t.changeType)throw"Update type is not implemented. TODO: Implement me!"}function k(t){var e,n;for(e=0;e<t.length;e+=1)n=t[e],n.node?P(n):n.link&&z(n);v()}function N(){m(),p()}function A(){O&&(O.release(),O=null)}function I(){t.off("changed",k)}function T(t,e){if(!e){var n=c(F);e={x:n.width/2,y:n.height/2}}var r=Math.pow(1.4,t?-.2:.2);return Q.scale=B.scale(r,e),d(),$.fire("scale",Q.scale),Q.scale}function S(){s.on("resize",N),A(),n("drag")&&(O=l(F),O.onDrag(function(t,e){B.translateRel(e.x,e.y),d()})),n("scroll")&&(O||(O=l(F)),O.onScroll(function(t,e,n){T(e<0,n)})),t.forEachNode(E),I(),t.on("changed",k)}function C(){q=!1,I(),A(),s.off("resize",N),$.off(),D.stop(),t.forEachLink(function(t){e.renderLinks&&w(t)}),t.forEachNode(function(t){_(t),x(t)}),R.dispose(),j()}var M=30;e=e||{};var U,D,O,R=e.layout,B=e.graphics,F=e.container,G=void 0===e.interactive||e.interactive,q=!1,Y=!0,X=0,V=0,W=!1,J=!1,H=!1,Q={offsetX:0,offsetY:0,scale:1},$=o({});return{run:function(t){return q||(r(),g(),L(),m(),S(),q=!0),h(t),this},reset:function(){B.resetScale(),m(),Q.scale=1},pause:function(){H=!0,D.stop()},resume:function(){H=!1,D.restart()},rerender:function(){return d(),this},zoomOut:function(){return T(!0)},zoomIn:function(){return T(!1)},moveTo:function(t,e){B.graphCenterChanged(Q.offsetX-t*Q.scale,Q.offsetY-e*Q.scale),d()},getGraphics:function(){return B},dispose:function(){C()},on:function(t,e){return $.on(t,e),this},off:function(t,e){return $.off(t,e),this}}}e.exports=r;var o=t("ngraph.events"),i=t("ngraph.forcelayout"),a=t("./svgGraphics.js"),s=t("../Utils/windowEvents.js"),u=t("../Input/domInputManager.js"),f=t("../Utils/timer.js"),c=t("../Utils/getDimensions.js"),l=t("../Input/dragndrop.js")},{"../Input/domInputManager.js":34,"../Input/dragndrop.js":35,"../Utils/getDimensions.js":43,"../Utils/timer.js":48,"../Utils/windowEvents.js":50,"./svgGraphics.js":52,"ngraph.events":7,"ngraph.forcelayout":9}],52:[function(t,e,n){function r(){function t(){var t=o("svg");return e=o("g").attr("buffered-rendering","dynamic"),t.appendChild(e),t}var e,n,r,s=0,u=0,f=1,c={},l={},d=function(t){return o("rect").attr("width",10).attr("height",10).attr("fill","#00a2e8")},p=function(t,e){t.attr("x",e.x-5).attr("y",e.y-5)},h=function(t){return o("line").attr("stroke","#999")},v=function(t,e,n){t.attr("x1",e.x).attr("y1",e.y).attr("x2",n.x).attr("y2",n.y)},g=function(t){t.fire("rescaled")},m={x:0,y:0},y={x:0,y:0},x={x:0,y:0},b=function(){if(e){var t="matrix("+f+", 0, 0,"+f+","+s+","+u+")";e.attr("transform",t)}};n=t();var w={getNodeUI:function(t){return c[t]},getLinkUI:function(t){return l[t]},node:function(t){if("function"==typeof t)return d=t,this},link:function(t){if("function"==typeof t)return h=t,this},placeNode:function(t){return p=t,this},placeLink:function(t){return v=t,this},beginRender:function(){},endRender:function(){},graphCenterChanged:function(t,e){s=t,u=e,b()},inputManager:a,translateRel:function(t,r){var o=n.createSVGPoint(),i=e.getCTM(),a=n.createSVGPoint().matrixTransform(i.inverse());o.x=t,o.y=r,o=o.matrixTransform(i.inverse()),o.x=(o.x-a.x)*i.a,o.y=(o.y-a.y)*i.d,i.e+=o.x,i.f+=o.y;var s="matrix("+i.a+", 0, 0,"+i.d+","+i.e+","+i.f+")";e.attr("transform",s)},scale:function(t,r){var o=n.createSVGPoint();o.x=r.x,o.y=r.y,o=o.matrixTransform(e.getCTM().inverse());var i=n.createSVGMatrix().translate(o.x,o.y).scale(t).translate(-o.x,-o.y),a=e.getCTM().multiply(i);f=a.a,s=a.e,u=a.f;var c="matrix("+a.a+", 0, 0,"+a.d+","+a.e+","+a.f+")";return e.attr("transform",c),g(this),f},resetScale:function(){f=1;var t="matrix(1, 0, 0, 1, 0, 0)";return e.attr("transform",t),g(this),this},init:function(t){t.appendChild(n),b(),"function"==typeof r&&r(n)},release:function(t){n&&t&&t.removeChild(n)},addLink:function(t,n){var r=h(t);if(r)return r.position=n,r.link=t,l[t.id]=r,e.childElementCount>0?e.insertBefore(r,e.firstChild):e.appendChild(r),r},releaseLink:function(t){var n=l[t.id];n&&(e.removeChild(n),delete l[t.id])},addNode:function(t,n){var r=d(t);if(r)return r.position=n,r.node=t,c[t.id]=r,e.appendChild(r),r},releaseNode:function(t){var n=c[t.id];n&&(e.removeChild(n),delete c[t.id])},renderNodes:function(){for(var t in c)if(c.hasOwnProperty(t)){var e=c[t];m.x=e.position.x,m.y=e.position.y,p(e,m,e.node)}},renderLinks:function(){for(var t in l)if(l.hasOwnProperty(t)){var e=l[t];y.x=e.position.from.x,y.y=e.position.from.y,x.x=e.position.to.x,x.y=e.position.to.y,v(e,y,x,e.link)}},getGraphicsRoot:function(t){return"function"==typeof t&&(n?t(n):r=t),n},getSvgRoot:function(){return n}};return i(w),w}e.exports=r;var o=t("simplesvg"),i=t("ngraph.events"),a=t("../Input/domInputManager.js")},{"../Input/domInputManager.js":34,"ngraph.events":7,simplesvg:28}],53:[function(t,e,n){function r(t){t=c(t,{enableBlending:!0,preserveDrawingBuffer:!1,clearColor:!1,clearColorValue:{r:1,g:1,b:1,a:1}});var e,n,r,l,d,p,h,v,g=0,m=0,y=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x=[],b=[],w={},E={},_=i(),L=a(),j=function(t){return s()},P=function(t){return u(3014898687)},z=function(){_.updateTransform(y),L.updateTransform(y)},k=function(){y=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},N=function(){e&&n&&(l=n.width=Math.max(e.offsetWidth,1),d=n.height=Math.max(e.offsetHeight,1),r&&r.viewport(0,0,l,d),_&&_.updateSize(l/2,d/2),L&&L.updateSize(l/2,d/2));
},A=function(t){t.fire("rescaled")};n=window.document.createElement("canvas");var I={getLinkUI:function(t){return E[t]},getNodeUI:function(t){return w[t]},node:function(t){if("function"==typeof t)return j=t,this},link:function(t){if("function"==typeof t)return P=t,this},placeNode:function(t){return p=t,this},placeLink:function(t){return h=t,this},inputManager:o,beginRender:function(){},endRender:function(){m>0&&_.render(),g>0&&L.render()},bringLinkToFront:function(t){var e,n,r=_.getFrontLinkId();_.bringToFront(t),r>t.id&&(e=t.id,n=b[r],b[r]=b[e],b[r].id=r,b[e]=n,b[e].id=e)},graphCenterChanged:function(t,e){y[12]=2*t/l-1,y[13]=1-2*e/d,z()},addLink:function(t,e){var n=m++,r=P(t);return r.id=n,r.pos=e,_.createLink(r),b[n]=r,E[t.id]=r,r},addNode:function(t,e){var n=g++,r=j(t);return r.id=n,r.position=e,r.node=t,L.createNode(r),x[n]=r,w[t.id]=r,r},translateRel:function(t,e){y[12]+=2*y[0]*t/l/y[0],y[13]-=2*y[5]*e/d/y[5],z()},scale:function(t,e){var n=2*e.x/l-1,r=1-2*e.y/d;return n-=y[12],r-=y[13],y[12]+=n*(1-t),y[13]+=r*(1-t),y[0]*=t,y[5]*=t,z(),A(this),y[0]},resetScale:function(){return k(),r&&(N(),z()),this},init:function(o){var i={};if(t.preserveDrawingBuffer&&(i.preserveDrawingBuffer=!0),e=o,N(),k(),e.appendChild(n),r=n.getContext("experimental-webgl",i),!r){var a="Could not initialize WebGL. Seems like the browser doesn't support it.";throw window.alert(a),a}if(t.enableBlending&&(r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.BLEND)),t.clearColor){var s=t.clearColorValue;r.clearColor(s.r,s.g,s.b,s.a),this.beginRender=function(){r.clear(r.COLOR_BUFFER_BIT)}}_.load(r),_.updateSize(l/2,d/2),L.load(r),L.updateSize(l/2,d/2),z(),"function"==typeof v&&v(n)},release:function(t){n&&t&&t.removeChild(n)},isSupported:function(){var t=window.document.createElement("canvas"),e=t&&t.getContext&&t.getContext("experimental-webgl");return e},releaseLink:function(t){m>0&&(m-=1);var e=E[t.id];delete E[t.id],_.removeLink(e);var n=e.id;if(n<m){if(0===m||m===n)return;var r=b[m];b[n]=r,r.id=n}},releaseNode:function(t){g>0&&(g-=1);var e=w[t.id];delete w[t.id],L.removeNode(e);var n=e.id;if(n<g){if(0===g||g===n)return;var r=x[g];x[n]=r,r.id=n,L.replaceProperties(e,r)}},renderNodes:function(){for(var t={x:0,y:0},e=0;e<g;++e){var n=x[e];t.x=n.position.x,t.y=n.position.y,p&&p(n,t),L.position(n,t)}},renderLinks:function(){if(!this.omitLinksRendering)for(var t={x:0,y:0},e={x:0,y:0},n=0;n<m;++n){var r=b[n],o=r.pos.from;e.x=o.x,e.y=-o.y,o=r.pos.to,t.x=o.x,t.y=-o.y,h&&h(r,e,t),_.position(r,e,t)}},getGraphicsRoot:function(t){return"function"==typeof t&&(n?t(n):v=t),n},setNodeProgram:function(t){if(!r&&t)L=t;else if(t)throw"Not implemented. Cannot swap shader on the fly... Yet."},setLinkProgram:function(t){if(!r&&t)_=t;else if(t)throw"Not implemented. Cannot swap shader on the fly... Yet."},transformClientToGraphCoordinates:function(t){return t.x=2*t.x/l-1,t.y=1-2*t.y/d,t.x=(t.x-y[12])/y[0],t.y=(t.y-y[13])/y[5],t.x=t.x*(l/2),t.y=t.y*(-d/2),t},transformGraphToClientCoordinates:function(t){return t.x=t.x/(l/2),t.y=t.y/(-d/2),t.x=t.x*y[0]+y[12],t.y=t.y*y[5]+y[13],t.x=(t.x+1)*l/2,t.y=(1-t.y)*d/2,t},getNodeAtClientPos:function(t,e){if("function"!=typeof e)return null;this.transformClientToGraphCoordinates(t);for(var n=0;n<g;++n)if(e(x[n],t.x,t.y))return x[n].node;return null}};return f(I),I}e.exports=r;var o=t("../Input/webglInputManager.js"),i=t("../WebGL/webglLinkProgram.js"),a=t("../WebGL/webglNodeProgram.js"),s=t("../WebGL/webglSquare.js"),u=t("../WebGL/webglLine.js"),f=t("ngraph.events"),c=t("ngraph.merge")},{"../Input/webglInputManager.js":36,"../WebGL/webglLine.js":61,"../WebGL/webglLinkProgram.js":62,"../WebGL/webglNodeProgram.js":63,"../WebGL/webglSquare.js":64,"ngraph.events":7,"ngraph.merge":13}],54:[function(t,e,n){function r(t){var e=10414335;if("string"==typeof t&&t)if(4===t.length&&(t=t.replace(/([^#])/g,"$1$1")),9===t.length)e=parseInt(t.substr(1),16);else{if(7!==t.length)throw'Color expected in hex format with preceding "#". E.g. #00ff00. Got value: '+t;e=parseInt(t.substr(1),16)<<8|255}else"number"==typeof t&&(e=t);return e}e.exports=r},{}],55:[function(t,e,n){function r(t){this.canvas=window.document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.isDirty=!1,this.canvas.width=this.canvas.height=t}e.exports=r},{}],56:[function(t,e,n){function r(t){function e(e,n){var r=t.createShader(n);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(r);throw window.alert(o),o}return r}function n(n,r){var o=t.createProgram(),i=e(n,t.VERTEX_SHADER),a=e(r,t.FRAGMENT_SHADER);if(t.attachShader(o,i),t.attachShader(o,a),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS)){var s=t.getShaderInfoLog(o);throw window.alert(s),s}return o}function r(t,e,n){if((e+1)*n>t.length){var r=new Float32Array(t.length*n*2);return r.set(t),r}return t}function a(e,n){for(var r={},o=0;o<n.length;++o){var i=n[o],a=-1;if("a"===i[0]&&"_"===i[1]){if(a=t.getAttribLocation(e,i),a===-1)throw new Error("Program doesn't have required attribute: "+i);r[i.slice(2)]=a}else{if("u"!==i[0]||"_"!==i[1])throw new Error("Couldn't figure out your intent. All uniforms should start with 'u_' prefix, and attributes with 'a_'");if(a=t.getUniformLocation(e,i),null===a)throw new Error("Program doesn't have required uniform: "+i);r[i.slice(2)]=a}}return r}return{createProgram:n,extendArray:r,copyArrayPart:o,swapArrayPart:i,getLocations:a,context:t}}function o(t,e,n,r){for(var o=0;o<r;++o)t[e+o]=t[n+o]}function i(t,e,n,r){for(var o=0;o<r;++o){var i=t[e+o];t[e+o]=t[n+o],t[n+o]=i}}e.exports=r},{}],57:[function(t,e,n){function r(t){function e(){var t;for(E.isDirty=!1,t=0;t<b.length;++t)b[t].isDirty=!1}function n(t){var e=y[t];if(!e)return!1;if(delete y[t],m-=1,m===e.offset)return!0;var n=c(e.offset),r=c(m);p(r,n);var o=y[w[m]];return o.offset=e.offset,w[e.offset]=w[m],d(),!0}function r(){return b}function a(t){return y[t]}function s(t,e){if(y.hasOwnProperty(t))e(y[t]);else{var n=new window.Image,r=m;m+=1,n.crossOrigin="anonymous",n.onload=function(){d(),f(r,n,e)},n.src=t}}function u(){var t=new i(v*g);b.push(t)}function f(t,e,n){var r=c(t),o={offset:t};r.textureNumber>=b.length&&u();var i=b[r.textureNumber];i.ctx.drawImage(e,r.col*g,r.row*g,g,g),w[t]=e.src,y[e.src]=o,i.isDirty=!0,n(o)}function c(e){var n=e/t<<0,r=e%t,o=r/v<<0,i=r%v;return{textureNumber:n,row:o,col:i}}function l(){E.isDirty=!0,x=0,h=null}function d(){h&&(window.clearTimeout(h),x+=1,h=null),x>10?l():h=window.setTimeout(l,400)}function p(t,e){var n=b[t.textureNumber].canvas,r=b[e.textureNumber].ctx,o=e.col*g,i=e.row*g;r.drawImage(n,t.col*g,t.row*g,g,g,o,i,g,g),b[t.textureNumber].isDirty=!0,b[e.textureNumber].isDirty=!0}var h,v=Math.sqrt(t||1024)<<0,g=v,m=1,y={},x=0,b=[],w=[];if(!o(t))throw"Tiles per texture should be power of two.";var E={isDirty:!1,clearDirty:e,remove:n,getTextures:r,getCoordinates:a,load:s};return E}function o(t){return 0===(t&t-1)}var i=t("./texture.js");e.exports=r},{"./texture.js":55}],58:[function(t,e,n){function r(t,e){return{_texture:0,_offset:0,size:"number"==typeof t?t:32,src:e}}e.exports=r},{}],59:[function(t,e,n){function r(){function t(t,e){t.nativeObject&&g.deleteTexture(t.nativeObject);var n=g.createTexture();g.activeTexture(g["TEXTURE"+e]),g.bindTexture(g.TEXTURE_2D,n),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,t.canvas),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR_MIPMAP_NEAREST),g.generateMipmap(g.TEXTURE_2D),g.uniform1i(x["sampler"+e],e),t.nativeObject=n}function e(){if(h.isDirty){var e,n=h.getTextures();for(e=0;e<n.length;++e)!n[e].isDirty&&n[e].nativeObject||t(n[e],e);h.clearDirty()}}function n(t){g=t,y=s(t),h=new a(z),v=y.createProgram(P,j),g.useProgram(v),x=y.getLocations(v,["a_vertexPos","a_customAttributes","u_screenSize","u_transform","u_sampler0","u_sampler1","u_sampler2","u_sampler3","u_tilesPerTexture"]),g.uniform1f(x.tilesPerTexture,z),g.enableVertexAttribArray(x.vertexPos),g.enableVertexAttribArray(x.customAttributes),m=g.createBuffer()}function r(t,e){var n=t.id*L;N[n]=e.x-t.size,N[n+1]=e.y-t.size,N[n+2]=4*t._offset,N[n+3]=e.x+t.size,N[n+4]=e.y-t.size,N[n+5]=4*t._offset+1,N[n+6]=e.x-t.size,N[n+7]=e.y+t.size,N[n+8]=4*t._offset+2,N[n+9]=e.x-t.size,N[n+10]=e.y+t.size,N[n+11]=4*t._offset+2,N[n+12]=e.x+t.size,N[n+13]=e.y-t.size,N[n+14]=4*t._offset+1,N[n+15]=e.x+t.size,N[n+16]=e.y+t.size,N[n+17]=4*t._offset+3}function u(t){N=y.extendArray(N,k,L),k+=1;var e=h.getCoordinates(t.src);e?t._offset=e.offset:(t._offset=0,h.load(t.src,function(e){t._offset=e.offset}))}function f(t){k>0&&(k-=1),t.id<k&&k>0&&(t.src&&h.remove(t.src),y.copyArrayPart(N,t.id*L,k*L,L))}function c(t,e){e._offset=t._offset}function l(t){_=!0,E=t}function d(t,e){b=t,w=e,_=!0}function p(){g.useProgram(v),g.bindBuffer(g.ARRAY_BUFFER,m),g.bufferData(g.ARRAY_BUFFER,N,g.DYNAMIC_DRAW),_&&(_=!1,g.uniformMatrix4fv(x.transform,!1,E),g.uniform2f(x.screenSize,b,w)),g.vertexAttribPointer(x.vertexPos,2,g.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),g.vertexAttribPointer(x.customAttributes,1,g.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,8),e(),g.drawArrays(g.TRIANGLES,0,6*k)}var h,v,g,m,y,x,b,w,E,_,L=18,j=o(),P=i(),z=1024,k=0,N=new Float32Array(64);return{load:n,position:r,createNode:u,removeNode:f,replaceProperties:c,updateTransform:l,updateSize:d,render:p}}function o(){return["precision mediump float;","varying vec4 color;","varying vec3 vTextureCoord;","uniform sampler2D u_sampler0;","uniform sampler2D u_sampler1;","uniform sampler2D u_sampler2;","uniform sampler2D u_sampler3;","void main(void) {","   if (vTextureCoord.z == 0.) {","     gl_FragColor = texture2D(u_sampler0, vTextureCoord.xy);","   } else if (vTextureCoord.z == 1.) {","     gl_FragColor = texture2D(u_sampler1, vTextureCoord.xy);","   } else if (vTextureCoord.z == 2.) {","     gl_FragColor = texture2D(u_sampler2, vTextureCoord.xy);","   } else if (vTextureCoord.z == 3.) {","     gl_FragColor = texture2D(u_sampler3, vTextureCoord.xy);","   } else { gl_FragColor = vec4(0, 1, 0, 1); }","}"].join("\n")}function i(){return["attribute vec2 a_vertexPos;","attribute float a_customAttributes;","uniform vec2 u_screenSize;","uniform mat4 u_transform;","uniform float u_tilesPerTexture;","varying vec3 vTextureCoord;","void main(void) {","   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);","float corner = mod(a_customAttributes, 4.);","float tileIndex = mod(floor(a_customAttributes / 4.), u_tilesPerTexture);","float tilesPerRow = sqrt(u_tilesPerTexture);","float tileSize = 1./tilesPerRow;","float tileColumn = mod(tileIndex, tilesPerRow);","float tileRow = floor(tileIndex/tilesPerRow);","if(corner == 0.0) {","  vTextureCoord.xy = vec2(0, 1);","} else if(corner == 1.0) {","  vTextureCoord.xy = vec2(1, 1);","} else if(corner == 2.0) {","  vTextureCoord.xy = vec2(0, 0);","} else {","  vTextureCoord.xy = vec2(1, 0);","}","vTextureCoord *= tileSize;","vTextureCoord.x += tileColumn * tileSize;","vTextureCoord.y += tileRow * tileSize;","vTextureCoord.z = floor(floor(a_customAttributes / 4.)/u_tilesPerTexture);","}"].join("\n")}var a=t("./webglAtlas.js"),s=t("./webgl.js");e.exports=r},{"./webgl.js":56,"./webglAtlas.js":57}],60:[function(t,e,n){function r(t){function e(){x=null}function n(t){x=t}function r(t){return"function"==typeof t&&P.push(t),k}function i(t){return"function"==typeof t&&j.push(t),k}function a(t){return"function"==typeof t&&L.push(t),k}function s(t){return"function"==typeof t&&_.push(t),k}function u(t){return"function"==typeof t&&E.push(t),k}function f(t){return"function"==typeof t&&w.push(t),k}function c(t){return"function"==typeof t&&b.push(t),k}function l(t,e,n){if(t&&t.size){var r=t.position,o=t.size;return r.x-o<e&&e<r.x+o&&r.y-o<n&&n<r.y+o}return!0}function d(e){return t.getNodeAtClientPos(e,l)}function p(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function h(t){return p(t),!1}function v(t,e){var n,r;for(n=0;n<t.length;n+=1)if(r=t[n].apply(void 0,e))return!0}function g(t){var e={x:0,y:0},n=null,r=1,i=+new Date,a=function(t){v(L,[n,t]),e.x=t.clientX,e.y=t.clientY},s=function(){o.off("mousemove",a),o.off("mouseup",s)},u=function(){y=t.getBoundingClientRect()};window.addEventListener("resize",u),u(),t.addEventListener("mousemove",function(t){if(!x){r++%7===0&&(u(),r=1);var o,i=!1;e.x=t.clientX-y.left,e.y=t.clientY-y.top,o=d(e),o&&n!==o?(n=o,i=i||v(b,[n])):null===o&&n!==o&&(i=i||v(w,[n]),n=null),i&&p(t)}}),t.addEventListener("mousedown",function(t){var r,i=!1;u(),e.x=t.clientX-y.left,e.y=t.clientY-y.top,r=[d(e),t],r[0]?(i=v(E,r),o.on("mousemove",a),o.on("mouseup",s),m=window.document.onselectstart,window.document.onselectstart=h,n=r[0]):n=null,i&&p(t)}),t.addEventListener("mouseup",function(t){var r,o=+new Date;e.x=t.clientX-y.left,e.y=t.clientY-y.top;var a=d(e),s=a===n;r=[a||n,t],r[0]&&(window.document.onselectstart=m,o-i<400&&s?v(P,r):v(j,r),i=o,v(_,r)&&p(t))})}if(t.webglInputEvents)return t.webglInputEvents;var m,y,x=null,b=[],w=[],E=[],_=[],L=[],j=[],P=[],z=t.getGraphicsRoot();g(z);var k={mouseEnter:c,mouseLeave:f,mouseDown:u,mouseUp:s,mouseMove:a,click:i,dblClick:r,mouseCapture:n,releaseMouseCapture:e};return t.webglInputEvents=k,k}var o=t("../Utils/documentEvents.js");e.exports=r},{"../Utils/documentEvents.js":41}],61:[function(t,e,n){function r(t){return{color:o(t)}}var o=t("./parseColor.js");e.exports=r},{"./parseColor.js":54}],62:[function(t,e,o){function i(){var t,e,o,i,u,f,c,l,p,h,v=6,g=2*(2*Float32Array.BYTES_PER_ELEMENT+Uint32Array.BYTES_PER_ELEMENT),m=["precision mediump float;","varying vec4 color;","void main(void) {","   gl_FragColor = color;","}"].join("\n"),y=["attribute vec2 a_vertexPos;","attribute vec4 a_color;","uniform vec2 u_screenSize;","uniform mat4 u_transform;","varying vec4 color;","void main(void) {","   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);","   color = a_color.abgr;","}"].join("\n"),x=0,b=new ArrayBuffer(16*g),w=new Float32Array(b),E=new Uint32Array(b),_=[],L=function(){if((x+1)*g>b.byteLength){var t=new ArrayBuffer(2*b.byteLength),e=new Float32Array(t),n=new Uint32Array(t);n.set(E),w=e,E=n,b=t}};return{load:function(n){e=n,i=Viva.Graph.webgl(n),t=i.createProgram(y,m),e.useProgram(t),u=i.getLocations(t,["a_vertexPos","a_color","u_screenSize","u_transform"]),e.enableVertexAttribArray(u.vertexPos),e.enableVertexAttribArray(u.color),o=e.createBuffer()},position:function(t,e,n){var r=t.id,o=r*v;w[o]=e.x,w[o+1]=e.y,E[o+2]=t.color,w[o+3]=n.x,w[o+4]=n.y,E[o+5]=t.color},createLink:function(t){L(),x+=1,_[t.id]=t,f=t.id},removeLink:function(t){x>0&&(x-=1),t.id<x&&x>0&&i.copyArrayPart(E,t.id*v,x*v,v)},updateTransform:function(t){h=!0,p=t},updateSize:function(t,e){c=t,l=e,h=!0},render:function(){function i(t){for(var i=[],f=0;f<t.length;f++){if(t[f]!=t[f+3]||t[f+1]!=t[f+4]){points=[],pointsMid=[];var d=t[f]-t[f+3],v=t[f+1]-t[f+4],g=(t[f]+t[f+3])/2,m=(t[f+1]+t[f+4])/2,y=g*m,x=1;if(void 0==i[y])i[y]=x;else{var b=i[y];x=b+1,i[y]=x}n=1,x>1&&(n=2),a=Math.atan2(v,d)*(180/Math.PI),r=Math.sqrt(d*d+v*v)/2,angle=a*Math.PI/180,dA=Math.PI/n;for(var w=x/5,E=g+r*Math.cos(angle+0*dA),_=m+r*Math.sin(angle+0*dA),L=g*w+r*Math.cos(angle+n/2*dA),j=m*w+r*Math.sin(angle+n/2*dA),P=g+r*Math.cos(angle+n*dA),z=m+r*Math.sin(angle+n*dA),k=new s(E,_,L,j,P,z),N=k.getLUT(20),A=0;A<N.length;A++){var I=N[A].x,T=N[A].y;points.push(I,T,.2)}e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array(points),e.DYNAMIC_DRAW),h&&(h=!1,e.uniformMatrix4fv(u.transform,!1,p),e.uniform2f(u.screenSize,c,l)),e.vertexAttribPointer(u.vertexPos,2,e.FLOAT,!1,3*Float32Array.BYTES_PER_ELEMENT,0),e.vertexAttribPointer(u.color,4,e.UNSIGNED_BYTE,!0,3*Float32Array.BYTES_PER_ELEMENT,8),e.drawArrays(e.LINE_STRIP,0,points.length/3)}f+=5}}e.useProgram(t),d=0,j=0;i(w)},bringToFront:function(t){f>t.id&&i.swapArrayPart(w,t.id*v,f*v,v),f>0&&(f-=1)},getFrontLinkId:function(){return f}}}var s=(t("./webgl.js"),t("../Utils/bezier.js"));e.exports=i},{"../Utils/bezier.js":39,"./webgl.js":56}],63:[function(t,e,n){function r(){function t(){if((P+1)*b>=_.byteLength){var t=new ArrayBuffer(2*_.byteLength),e=new Float32Array(t),n=new Uint32Array(t);n.set(j),L=e,j=n,_=t}}function e(t){l=t,h=o(t),c=h.createProgram(E,w),l.useProgram(c),p=h.getLocations(c,["a_vertexPos","a_color","u_screenSize","u_transform"]),l.enableVertexAttribArray(p.vertexPos),l.enableVertexAttribArray(p.color),d=l.createBuffer()}function n(t,e){var n=t.id;L[n*x]=e.x,L[n*x+1]=-e.y,L[n*x+2]=t.size,j[n*x+3]=t.color}function r(t){y=!0,m=t}function i(t,e){v=t,g=e,y=!0}function a(t){P>0&&(P-=1),t.id<P&&P>0&&h.copyArrayPart(j,t.id*x,P*x,x)}function s(){t(),P+=1}function u(){}function f(){l.useProgram(c),l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,_,l.DYNAMIC_DRAW),y&&(y=!1,l.uniformMatrix4fv(p.transform,!1,m),l.uniform2f(p.screenSize,v,g)),l.vertexAttribPointer(p.vertexPos,3,l.FLOAT,!1,x*Float32Array.BYTES_PER_ELEMENT,0),l.vertexAttribPointer(p.color,4,l.UNSIGNED_BYTE,!0,x*Float32Array.BYTES_PER_ELEMENT,12),l.drawArrays(l.POINTS,0,P)}var c,l,d,p,h,v,g,m,y,x=4,b=3*Float32Array.BYTES_PER_ELEMENT+Uint32Array.BYTES_PER_ELEMENT,w=["precision mediump float;","varying vec4 color;","void main(void) {","   gl_FragColor = color;","}"].join("\n"),E=["attribute vec3 a_vertexPos;","attribute vec4 a_color;","uniform vec2 u_screenSize;","uniform mat4 u_transform;","varying vec4 color;","void main(void) {","   gl_Position = u_transform * vec4(a_vertexPos.xy/u_screenSize, 0, 1);","   gl_PointSize = a_vertexPos.z * u_transform[0][0];","   color = a_color.abgr;","}"].join("\n"),_=new ArrayBuffer(16*b),L=new Float32Array(_),j=new Uint32Array(_),P=0;return{load:e,position:n,updateTransform:r,updateSize:i,removeNode:a,createNode:s,replaceProperties:u,render:f}}var o=t("./webgl.js");e.exports=r},{"./webgl.js":56}],64:[function(t,e,n){function r(t,e){return{size:"number"==typeof t?t:10,color:o(e)}}var o=t("./parseColor.js");e.exports=r},{"./parseColor.js":54}],65:[function(t,e,n){e.exports="0.8.1"},{}]},{},[1])(1)});